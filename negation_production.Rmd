---
title             : "The production of negation in parents' and children's speech"
shorttitle        : "Child and Parent Production of Negation"

author: 
  - name          : "Masoud Jasbi"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "469 Kerr Hall, University of California, One Shields Avenue, Davis, CA, 95616"
    email         : "jasbi@ucdavis.edu"
  - name          : "Annika Mcdermott-Hinman"
    affiliation   : "2"
  - name          : "Kathryn Davidson"
    affiliation   : "2"
  - name          : "Susan Carey"
    affiliation   : "2"

affiliation:
  - id            : "1"
    institution   : "UC Davis"
  - id            : "2"
    institution   : "Harvard University"

authornote: |
  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

  Enter author note here.

abstract: |
  this is the abstract
  
  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "negation, production, child language"
wordcount         : "X"

bibliography      : ["r-references.bib", "negation_production_references.bib"]

floatsintext      : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : yes

documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_pdf
---

```{r setup, include = FALSE}
library("papaja")
library(devtools)
library(childesr)
library(tidyverse)
library(tm)
library(forcats)
library(gridExtra)
```

<!-- TO DO
+ Put binomial errorbars on the developmental plots
+ Parent speech bottleneck simulation (for each month bin, sample from parent speech with the utterance length distribution children have)
+ What are precise definitions of stagehood?
+ Subject-drop in negative vs. positive sentences
+ French and German as extension?
-->

# Introduction

Under Construction! 

<!--
In a coffee shop, it is common to see the menu divided into "coffee" and "not coffee" sections. As expected, the coffee section has drinks that contain coffee like espresso, latte, and cappuccino. The "not coffee" section, however, contains a variety of items including tea, orange juice, and lemonade. What brings these items together is not what they are, but rather what they are not; and the word *not* combined with the word *coffee* allows us to capture this complex concept. All known human languages have the ability to create negative expressions from a variety of positive ones they already have in a productive and combinatorial manner. Compositionality and abstractness are important components that make human languages so powerful. But how does this linguistic ability develop? How do we learn to use linguistic negation?

Possible origins: 1. Metalinguistic and conceptual categorization (labeling) 2. Higher Perceptual (existence) 3. affective (rejections, wants, likes) 4. Motor (prohibitions). Two hypothesis: 1. unified concept of negation that is incorporated to operate on different representations and 2. heterogeneous concepts of negation that develop independently but can be generalized into a single concept.

Negation in natural language is a concept that operates on concepts. It is higher order. It is likely that it starts as such early on with labeling acts; as a way of organizing concepts.
-->

## Previous Studies

<!--form-->
@klimaBellugi1966 provided the first and most influential account of negation development. They used fortnightly recordings of mother-child conversations for three children in the @brown1973first corpus: Eve (18-26 months), Adam and Sarah (26-50 months). They divided child utterances into three stages:"the first stage from the first month of study for each child; the last from the month in which the MLUs approach 4.0 for each of the three children; and the second stage between the two." They suggested that in Stage 1, the syntactic category of negation (NEG) includes *no* and *not*, produced before or after a sentence "nucleus", i.e. noun and verb phrase without tense or inflection (NEG+S or S+NEG). Examples include:  "No singing song", "No the sun shining", "No money", "No play that", "Wear mitten no", "No fall!", and "Not a teddy bear". It was hypothesized that auxiliary negatives like *don't* and *can't* are not produced or understood at this stage. In Stage 2, children add *can't* and *don't* as unanalyzed wholes to their list of negators, and move negation inside the sentence, between the subject and the verb phrase (NP+NEG+VP). The main evidence for *can't* and *don't* being unanalyzed wholes in this stage is the absence of positive auxiliary variants like *can* and *do*. Typical examples at this stage include "I can't see you", "I don't want it", "He not little, he big", "There no squirrels", "He no bite you", and "I no want envelope". In Stage 3, auxiliary verbs like *can't* and *don't* are re-analyzed as AUX+NEG, additional negative auxiliaries like *won't* and *isn't* are produced, and positive auxiliaries like *can* and *do* are produced for the first time (NP+AUX+NEG+VP). @klimaBellugi1966's account was in line with the transformational theory of negation at the time, which hypothesized that adult negation starts as a sentence modifier at deep structure, and a transformation later moves it inside the sentence [@klima1964negation]. Therefore, children's first stage was interpreted to reflect a universal innate initial state, and the second and third stages the process of learning the required surface-level transformations.  

However, further investigations proved the first stage to be controversial. @bloom1970 studied another three children (Kathryn, Eric, and Gia) between 19-27 months and did not find evidence for a sentence-external stage of negation (NEG+S / NEG+S). Children started with isolated *no* and once they produced multi-word utterances, they mostly combined *no* and *not* with noun and verb phrases (*no*/*not*+NP/VP). Nevertheless, @bloom1970 reported that Kathryn produced some instances of sentence-internal negation with *no* such as "Kathryn no like celery". @lord1974variations studied her own child Jennifer (19-26 months) and found no instances of sentence-external negation or sentence-internal *no*. She reported that her child started with single "no" utterances before 24 months and between 24-26 months started combining *no*/*not* with nominals, and *can't*/*don't* with verb phrases (*no*/*not*+NP and *can't*/*don't*+VP). Her conclusion was that the development of negation varies in children and not all of them go through the stages described by @klimaBellugi1966. 

However, @wode1977four used crosslinguistic data to support and expand @klimaBellugi1966's account. He compared productions of two German children (19-26 months), a Swedish child (20-42 months) from @lange1973syntactical, and English-speaking children from @bloom1970 and @klimaBellugi1966. He proposed four stages: 1. one-word stage with only *nein*, *nä/nej*, or *no*; 2. multiword anaphoric stage where the single words from stage 1 are used as a response to a previous utterance followed by other words (e.g. "no, outside!" or "nein, Milch"); 3. multiword non-anaphoric stage where a single-word negative like *no* is used sentence-externally instead of sentence-internally (e.g. "nein sauber" for "I don't want to be cleaned" or "no close" for "I can't close the box") 4. multiword intra-sentential negation where negation has moved inside the sentence (e.g. "Kathryn no like celery",  "I can't open it", or "ich habe nicht geschlafen"). In response to this proposal, @park1979some argued that @wode1977four's account relied on insufficient evidence given that it used only 13 examples and no proper distributional analysis. Furthermore, @park1979some presented data from three German speaking children around 21-25 months that did not match @wode1977four's developmental stages. 

The debate continued with @deVilliers1979 suggesting that previous studies provided little empirical evidence to support a general sentence-external stage. They investigated productions of Adam (27-31 months), Eve (18-22 months), and their own child Nicholas (23-29 months) and found very few sentence-external negatives with overt subjects that allowed for assessment of sentence boundary. They pointed out that even among these instances, many could plausibly be anaphoric. Despite these arguments, @deprez1993negation used examples from children's productions in English, French, and German to provide a novel syntactic analysis for presenential negation in child language within the Principles and Parameters framework [@chomsky1993lectures]. They argued that instead of negation moving from outside the sentence inside as @klimaBellugi1966 suggested, it is the subject NP that fails to move outside, from inside the VP. They suggested that child data is in line with the VP-internal subject hypothesis in adult grammar [@koopman1991position]. However unlike previous studies, they had counted utterances with omitted subjects as instances of presentential negation (or rather VP-internal subjects) as well. 

In response to @deprez1993negation, @StromswoldZimmermann2000 studied negation in five German-speaking children (Julia, Inga, Andreas, Kathrin, and Nicole) between 17 and 29 months. They found that out of 689 examples of negation, only one could plausibly support the hypothesis that at an early stage the negator can surface to the left of the subject and pre-sententially. @drozd1995 provided a similar but large-scale analysis for English. Using data available from 123 children in CHILDES between the ages of 11 and 40 months, the study looked at utterances beginning with *no*, *not*, and *never* and used the available linguistic context to classify them as anaphoric or non-anaphoric. The study found a total of 456 instances of pre-sentential negation, out of which only 31 (6.7%) could be classified as instances of non-anaphoric pre-sentential negation. He argued that the best explanation for such rare distribution of presentential negation is that they are meta-linguistic uses of negation. In other words, the child's "no the sun shining" is similar to the adult version "don't say the sun is shining (that's wrong)", and not some stage in the development of negation.

Two relatively recent studies have focused on @klimaBellugi1966's second stage, where children are reported to produce non-adult-like infinitival negatives with *no*, *not*, and *don't* (e.g. "He no/not/don't bite you"). At this stage, children are hypothesized to not differentiate these forms and consider all as variants of negation. They are also hypothesized to not analyse *don't* as auxiliary plus negation and rather consider it as an unanalyzed whole. The evidence was considered to be the absence of positive auxiliary forms like *do*. @schutze2010status provided a quantitative analysis of negation in the speech of five children (Abe, Adam, Sarah, Nina, Ross) between 2 and 5 years of age. He showed that the non-adult-like infinitival negatives are quite rare, never exceeding 5% of children's total productions. Instead he found that the only common error reaching about 10% of productions is non-agreeing *don't* in sentences with third-person singular subjects (e.g. "He don't bite you"). He proposed a grammatical account that could predict such errors. 

@thorntonTesan2013 disagreed with @schutze2010status and following @klimaBellugi1966 contended that children at the second stage have not yet identified *n't* as a separate form of negation. To explain this stage, they proposed that children start with the hypothesis that negative words like *not*, *not*, and *don't* are adverbs, thus producing sentences like "He no/not/don't bite you". Later in the third stage they realize that negation can also be a separate syntactic head showing agreement with subjects as in "He doesn't bite you". This analysis was inspired by @Zeijlstra2004's proposal for Negative Concord which divides languages into those with adverbial semantic negation and those with syntactic negation. @thorntonTesan2013 provided elicitation data on negative sentences with third-person singular subjects from four two-year-olds who had been recorded for about a year [@tesan2005children]. They found that in line with their proposal, children produced *not* (e.g. "This not fits in here") before producing *n't* (e.g. "this does not fit in here"). A similar finding regarding the order in which negative morphmes emerge in English was reported by @cameron2007part. They investigated the development of multiword negation in the speech of Brian (2;3-3;4, MLU 2.05-3.1) and reported that negative morphemes followed a *no*<*not*<*n't* trajectory, mirroring their order of frequency in parents' speech. Earliest multiword negation strategies were described as a combination of *no*/*not* with different types of phrases  (*no*/*not*+XP), with *don't* and *can't* being the first contracted forms to emerge.

To summarize, prevoius research has suggested that English-speaking children learn to produce negative morphemes in a *no*<*not*<*n't* order. Among negative auxiliary forms, *can't* and *don't* are learned first and before any positive auxiliary form including *can* and *do*. @klimaBellugi1966 argued that children's production of English negation becomes adult-like after two non-adult-like stages: one in which they produce negation before a sentence and never inside it, and another in which they produce it within the sentence but do not use the right negative morpheme (e.g. "He not little" instead of "He isn't little"). There has been an active debate over each of these stages. With the exception of @drozd1995, previous studies have mainly relied on data from a few available children often including the original data from @klimaBellugi1966. Given that over the years much more corpus data and computational tools have become available, it is important to revisit previous proposals and assess their current status.

## Current Study

```{r exclusions}
exclusions <- read_csv("processed_data/token_exclusions.csv")
uexclusions <- read_csv("processed_data/u_exclusions.csv")
```

This paper builds on the rich literature on children's production of negation by bringing the largest dataset of English parent-child interactions available in CHILDES [@macwhinney2000childes]. Study 1 investigates the frequency of production for each negative morpheme in parents' and children's speech during the first 6 years of children's development. More specifically the study checks to see if there is an overall *no* < *not* < *n't* cline [@cameron2007part], and if children produce negative auxiliary forms like *can't* and *don't* before their positive variants like *do* and *can*. Study 2 focuses on non-adult-like productions of negation in children and examines the prevalence of pre-sentential negation (e.g. "no the sun shining") as well as infinitival negation (e.g. "He no/not/don't bite you"). It also discusses the concept of stagehood and whether observed prevalances of such non-adult-like productions are best captured as a developmental stage. Study 3 looks for the most common negative syntactic structures present in parents' and children's speech. It uses a current state-of-the-art parsing algorithm to provide a large-scale estimate of syntactic structures negation participates in as well as its productivity in parent-child interactions. We end with a discussion of English negation's combinatorial capacity in children's early speech and its possible origins.

# Study 1: Development of Negative Morphemes

The aim of this study was to assess the overall production of negative forms (especially *no*, *not*, and *n't*) in parents' and children's speech, and address the following questions: 1. Does the overall production of negation in children follow a *no*<*not*<*n't* cline [@cameron2007part]? 2. Do children produce negative auxiliary forms such as *can't* and *don’t* before using their positive variants, suggesting that the negative forms are learned as unanalyzed wholes? The answer to both questions was negative.

## Methods

For samples of parents' and children's speech, we used the online database [childes-db](childes-db.stanford.edu) and its associated R programming package `childesr` [@sanchez2019childes]. Childes-db is an online interface to the child language components of [TalkBank](https://talkbank.org/), namely [CHILDES](https://childes.talkbank.org/) [@macwhinney2000childes] and [PhonBank](https://phonbank.talkbank.org/). Two collections of corpora were selected: English-North America and English-UK. The dataset contained `r format(exclusions$after_age, big.mark=",")` tokens from `r exclusions$n_chi_age` children, after necessary exclusions. We ran a token-based analysis of the corpora as well as an utterance-based analysis that could take utterance length and context into account.

In our token-based analysis, all word tokens were tagged for the following information: 1. the speaker role (parent vs. child), 2. the age of the child when the word was produced in months, 3. whether the word was positive or negative, and 4. the type of negative word produced. For this study we considerd the following classes of negative morphemes in English: the forms *no* and *not*, all instances of negative auxiliary forms with *n't* as well as their positive forms without *n't* as controls. Unintelligible tokens were excluded (N = `r format(exclusions$unintelligible, big.mark=",")`), as well as tokens that had missing information on children's age (N = `r format(exclusions$missing, big.mark=",")`). Third, tokens outside the age range of 1 to 6 years were excluded (N = `r format(exclusions$age, big.mark=",")`) since children did not produce much outside this age range. These exclusions resulted in the exclusion of data `r exclusions$n_chi_total-exclusions$n_chi_age` children from the final analysis. Similarly, in our utterance-based analysis, each utterance was tagged for the following: 1. the number of tokens in the utterance 2. the speaker role (parent vs. child), 2. the age of the child, 3. whether the utterance contained *no*, *not*, or *n't*. Utterances with missing information on children's age (N = `r format(uexclusions$missing, big.mark=",")`) as well as those outside the age range of 1 to 6 years were excluded (N = `r format(uexclusions$age, big.mark=",")`). The collection contained X utterances from N children.

<!--
3. the type of the utterance the word appeared in (declarative, question, imperative, other)[^1]

[^1]: This study grouped utterance types into four main categories: "declarative", "question", "imperative", and "other". Utterance type categorization followed the convention used in the [TalkBank manual](https://talkbank.org/manuals/CHAT.html#_Toc486414422). The utterance types are similar to sentence types (declarative, interrogative, imperative) with one exception: the category "question" consists of interrogatives as well as rising declaratives (i.e. declaratives with rising question intonation). In the transcripts, declaratives are marked with a period, questions with a question mark, and imperatives with an exclamation mark. It is important to note that the manual also provides [terminators for special-type utterances](https://talkbank.org/manuals/CHAT.html#_Toc486414431). Among the special type utterances, this study included the following in the category "questions": trailing off of a question, question with exclamation, interruption of a question, and self-interrupted question. The category imperatives also included "emphatic imperatives". The rest of the special type utterances such as "interruptions" and "trailing off" were included in the category "other".
-->

## Results

We first look at the proportions of different categories of negation in parents' and children's speech (Figure \@ref(fig:negationProportionPlot)). The most frequent form in parents' speech was the contracted auxiliary negation *n't*, followed by *no*, and finally *not*. In children's productions and between the ages of 12-18 months, almost all negative forms are instances of *no*, with some contracted auxiliary negatives like *don't* and *can't*. As children grow older, the proportions of *not* and its contracted form *n't* increase while the proportion of *no* decreases. Similar to @cameron2007part we find that children start productions of *no* earlier than other forms. However, we do not find evidence that the full form *not* is produced before its contracted form *n't*. The results in Figure \@ref(fig:negationProportionPlot) suggest that children start producing *not* and *n't* around the same time, if not slightly earlier for *n't*.

```{r negationProportionPlot, fig.env="figure", fig.height=3, fig.cap="Proportion of different categories of negation in parents' and children's speech between 1 to 6 years of age."}
negative_proportions <- readRDS("processed_data/negation_proportions")

negative_proportions %>%
  filter(!(age==12 & speaker=="child")) %>%
  filter(category !="quantifier", category !="derivational", category !="adverb") %>%
  ggplot(aes(age,percent, color=category)) +
  geom_point(aes(color=category, shape=category)) +
  geom_line(aes(color=category)) +
#  geom_smooth(span=0.9) +
  scale_x_continuous(breaks=seq(0, 72, by = 6)) +
  facet_grid(.~speaker) +
  theme_classic()
```

Figure \@ref(fig:negationRelativeFrequency) shows the relative frequency of the morphemes *no*, *not* and *n't* per thousand words in the speech of parents and children. Children start producing *no* between 12-18 months and they immediately surpass their parents' rate of production for this morpheme. Betwen 18-42 months children produce two to three times more instances of *no* than their parents. This rapid incrase and high frequency of *no* may be partly because parents ask many yes/no questions from children in this age range. After 42 months the frequency of *no* reduces substantially and gets closer to parents' level of 10 per thousand. For the negative morpheme *not*, children start their productions between 12-24 months and by 30 months of age, they are producing *not* at the same rate as their parents (5 per thousand words). After 36 months children's rate of *not* productions stay similar to their parents. Finally for the contracted form *n't*, children's productions start between 12-18 months and by 24 months they reach a rate of 5 instances per thousand words. They keep increasing this rate until they reach their parents' rate of 15 instances per thousand at age 36 months. It is important to note that for all these negative forms, children have reached an adult-level of production (in terms of relative frequency) by 30 months of age.

```{r negationRelativeFrequency, fig.env="figure", fig.width=7, fig.height=2.5, fig.cap="Relative frequency (parts per thousand) of the response particle *no*, verb phrase negation *not*, and its contracted form *n't*"}
all_utterance_relfreqs <- readRDS("processed_data/all_utterance_relfreqs") 

all_utterance_relfreqs %>%
  filter(ppt!=0) %>%
  ggplot(aes(age, ppt, color=category)) +
  geom_point(aes(color=category, shape=category)) + 
  geom_line(aes(color=category)) +
#  geom_smooth(span=0.8) +
  scale_x_continuous(breaks=seq(0, 72, by = 6)) +
  facet_grid(.~speaker) +
  theme_classic()
```

@StromswoldZimmermann2000 found that in German-speaking children, the word *nein* was produced before *nicht* and discussed three potential causes for this order of production: input frequency, phonetic complexity, and syntactic complexity. They explained that input frequency cannot be the cause because in German-speaking children's input *nicht* was more frequent than *nein*. Similarly, English-speaking children hear more instances of *n't* than *no* so input frequency cannot be the cause in English either. With respect to phonetic complexity, German *nicht* has a voiceless palatal fricative that can potentially be hard for children and delay its production. However, English *no* and *not* are quite similar and do not contain phones that are known to be particularly hard for children. This leaves us with syntactic complexity which is an obvious difference between isolated one-word negators like *no*/*nein* and multiword negators like *not*/*nicht*. Given that children start with shorter utterances (typically one word) and produce longer ones as they grow up, they may produce *no* earlier than *not* and *n't* simply because *no* can appear as a single word utterance. In other words, even a hypothetical child that comprehends all negative forms *no*, *not*, and *nt* may produce *no* earlier than the other two because of production limitations. 

One way to address this issue in our dataset is to focus on children's multiword utterances. Is the main contributor to the high frequency of *no* single word utterances? To answer this question we removed single-token utterances like "yes", "no", and "oh", as well as utterances that combined such elements in a repetitive way like "no no" or "oh no" from children and parents' speech. If early appearance and high frequency of *no* is mainly due to short and repetitive utterances produced by children early in their development, it should disappear once we focus on multiword utterances. As Figure \@ref(fig:multiwordFrequency) shows, this is largely what we found. While the frequencies of *not* and *n't* in multi-word productions were similar to their overall frequencies seen before in Figure \@ref(fig:negationRelativeFrequency), the word *no* largely lost its advantage in frequency and early occurrence, showing a very similar developmental trajectory as the other two negative morphemes. This provides an indication that the earlier emergence of *no* may be due to children's production limitations and does not necessarily reflect earlier acquisition of this morpheme. The question of which form is acquired earlier may be better addressed by careful comprehension studies in the 12-24 month age range. It is important to note here that both Figure \@ref(fig:multiwordFrequency) and Figure \@ref(fig:negationRelativeFrequency) suggest the 12-18 months age range as a potential period where all three negative morphemes recieve their early form-meaning mappings. In order to better understand such early mappings of negation and their development we need more comprehension studies.

```{r multiwordFrequency, fig.env="figure", fig.width=7, fig.height=2.5, fig.cap="Relative frequency (parts per thousand) of the response particle *no*, verb phrase negation *not*, and its contracted form *n't* in multiword utterances"}
multiword_relfreqs <- readRDS("processed_data/multiword_relfreqs") 

  multiword_relfreqs %>%
  filter(ppt!=0) %>%
  ggplot(aes(age, ppt, color=category)) +
  geom_point(aes(color=category, shape=category)) + 
  geom_line(aes(color=category)) +
#  geom_smooth(span=0.8) +
  scale_x_continuous(breaks=seq(0, 72, by = 6)) +
  facet_grid(.~speaker) +
  theme_classic()
```

Moving to the second question: do negative auxiliaries appear before positive ones? Figure \@ref(fig:auxRelFreq) shows the relative frequency of positive and negative auxiliary forms in the speech of children and their parents. Our results show that overall, children start producing the positive and negative auxiliary forms around the same time and always produce the positive forms at a higher rate than negative ones. This is also true for individual auxiliary words such as *do/don't* and *can/can't* which are produced earlier than others. Therefore, the claim that negative auxiliary forms are produced before their positive counterparts is not supported by the available production data and consequently production data does not support the hypothesis that auxiliary negative forms are learned as unanalyzed wholes.  

```{r auxRelFreq, fig.env="figure", fig.width=6, fig.height=2.5, fig.cap="Relative frequency (parts per thousand) of positive auxiliary forms such as *do*, *are*, and *can* as well as their contracted negatives in the speech of parents and children."}
category_table <- readRDS(file="processed_data/category_table")

category_table %>%
  filter(category=="auxiliary") %>%
  ggplot(aes(age,ppt, color=polarity)) +
  geom_point(aes(color=polarity)) +
  geom_line(aes(color=polarity)) +
  facet_grid(.~speaker) +
#  geom_smooth() +
  scale_x_continuous(breaks=seq(0, 72, by = 6)) +
  theme_classic()
```

## Conclusions

The results of our corpus study suggest that children produce *no* earlier and more frequently than *not* and *n't*. We did not find strong evidence for *not* appearing before *n't* and the general trends suggested that they appear around the same time. While earlier emergence of *no* in production may suggest its earlier acquisition and comprehension, it is also possible that early emergence of *no* is due to its syntactic and usage properties. The morpheme *no* can be produced on its own as a speech act in response to speech participants, while negative forms *not* and *n't* require composition with other words. We found that when we consider only children's multiword utterances, the early emergence and advantage of *no* disappears. Therefore, the production data does not provide support for some strong order or stage of acquisition in children's acquisition of negative morphemes. We believe it is more appropriate for future comprehension research to adjudicate this matter.

We also investigated whether negative auxiliary forms such as *can't* and *don't* emerge before their positive counterparts such as *do* and *can*. Previous research had cited such a phenomenon as evidence for the proposal that negative auxiliary forms are first learned as unanalyzed wholes. Contrary to previous reports, our data showed that the positive auxiliary forms emerge around the same time as the negative ones but produced much more frequently. Therefore, production data does not provide evidence for negative auxiliaries being learned as unanalyzed forms.

# Study 2: Non-adult-like Productions

The aim of this study was to assess the prevalence of non-adult-like utterances in children's productions. @klimaBellugi1966's account of negation development relies on two types of non-adult-like utterances: 1. Pre-sentential instances where a negative morpheme is modifying a sentence (NEG + NP + VP); and 2. Intra-sentential instances, which in some cases fail to show the adult-like agreement (NP + *no*/*not*/*don't* + VP). How prevalent are such errors and what are their most likely sources?

## Methods

```{r exclusions}
child_exclusions2 <- read.csv("processed_data/study2_child_exclusions.csv")

parent_exclusions2 <- read.csv("processed_data/study2_parent_exclusions.csv")

```

In this study, we again used the English-North America and English-UK collections of corpora from CHILDES [@macwhinney2000childes]. We used the R programming package childesr [@sanchez2019childes] to run an utterance-based analysis of child and parent speech. The dataset contained data from `r child_exclusions2$n_chi_neg` children, with `r format(child_exclusions2$final_neg, big.mark = ",")` negative utterances produced by children and `r format(parent_exclusions2$final_neg, big.mark = ",")` negative utterances from their parents, after necessary exclusions.

Each utterance was binned by child age in months and tagged for 1. number of tokens in the utterance, 2. the speaker role (parent vs. child), and 3. whether the utterance was negative or positive. Negative utterances were further coded for the presence of *no*, *not*, and *n’t*, as well as for syntactic position of the negator. Untranscribed utterances and utterances missing part of speech tagging were excluded (N = `r format(child_exclusions2$not_transcribed, big.mark = ",")` for children, `r format(parent_exclusions2$not_transcribed, big.mark = ",")` for parents), and unintelligible tokens were removed. Repeated instances of ‘no’ (often coded with a single part of speech tag) were condensed to a single instance. Additionally, due to a large number of coding irregularities, utterances whose number of tokens did not match the number of part of speech tokens coded were excluded (N = `r format(child_exclusions2$pos_incorrect, big.mark = ",")` for children, `r format(parent_exclusions2$pos_incorrect, big.mark = ",")` for parents). Single-token negations were removed, as well as utterances in which the negative was combined repetitively with extra-syntactic particles (eg. “ah no”, “no oh oh”) (N = `r format(child_exclusions2$one_word, big.mark = ",")` for children, `r format(parent_exclusions2$one_word, big.mark = ",")` for parents).



## Results

```{r load data}
pre_no <- read.csv("processed_data/pre_no")
pre_no$no <- factor(pre_no$no, levels = c("no + NP + VP", "no + NP + VP (NEG)", "NP + VP + no", "NP + VP + no (NEG)", "NP + no + VP", "no + VP","no + NP", "other"))

p_pre_no <- read.csv("processed_data/p_pre_no")
p_pre_no$no <- factor(p_pre_no$no, levels = c("no + NP + VP", "no + NP + VP (NEG)", "NP + VP + no", "NP + VP + no (NEG)", "NP + no + VP", "no + VP","no + NP", "other"))

pre_not <- read.csv("processed_data/pre_not")
pre_not$not <- factor(pre_not$not, levels = c("not + NP + VP", "NP + VP + not", "NP + not + VP", "not + VP","not + NP","double neg", "other"))

third_sg <- read.csv("processed_data/thirdsg_neg")
third_sg <- mutate(third_sg, thirdsg = "Third-singular Utterances")

other_pos <- read.csv("processed_data/other_pos_neg")
other_pos <- mutate(other_pos, thirdsg = "Non-third-singular Utterances")

neg_3sg <- read.csv("processed_data/neg_3sg")
```

We first examined the claim, originally proposed by @klimaBellugi1966, that children go through an initial stage during which their negative utterances are of the form NEG+S or S+NEG, where the NEG element consists of *no* or *not*, interchangeably. @klimaBellugi1966 took examples such as “no fall” and “no play that” as evidence for this stage. However, @deVilliers1979 pointed out that in order to identify the sentence boundary, an overt subject must be present– that is, the sentence must be of the form NEG+NP+VP or NP+VP+NEG in order to ensure that the negator is truly sentence-external. We followed this convention in our analysis.

We tagged each instance of *no* and *not* uttered by children and their parents for the syntactic position of the negator. Figures \@ref(fig:ChildNoSyntaxPlot) and \@ref(fig:ParentNoSyntaxPlot) show this analysis for children’s and parents’ *no* utterances respectively, and Figure \@ref(fig:ChildNotSyntaxPlot) shows the same for children's *not* utterances. 

```{r ChildNoSyntaxPlot, fig.env="figure", fig.height= 3, fig.cap="Syntactic analysis of children's *no* utterances between 1 and 3 years of age."}
ggplot(pre_no, aes(bin, fill = no)) +
  geom_bar()+
  xlab("Child Age (months)")+
  ylab("Number of Instances")+
  theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust=1), plot.title = element_text(hjust = 0.5))+
  theme(legend.key=element_blank(), legend.key.size=unit(12,"point"))+
  labs(fill = "Syntactic Position") +
  scale_fill_brewer(palette="Paired")

```

We found that very few utterances of type S+NEG occurred, for either no utterances (<8% per age bin) or *not* utterances (<2% per age bin). *Not* utterances of the form NEG+S were also rare (<5% per age bin). Utterances of the form NEG+S with *no* as the NEG element made up a much more substantial proportion of children’s utterances. The S element of many of these utterances was negative itself (eg. "no I not cold anymore"; labeled "no + NP + VP (NEG)"). Because these utterances exhibited already developed intra-sentential negation, and because of the high computational demands of double negation [@thorntonTesan2013], the *no* in these instances was presumed to be anaphoric- negating a previous utterance or event. We also claim that the distribution of the single-negative NEG+S utterances was more consistent with the hypothesis that these utterances are largely anaphoric (Bloom, 1970; Wode, 1977) than with @klimaBellugi1966’s claim that they are true sentential negation. 

```{r ParentNoSyntaxPlot, fig.env="figure", fig.height= 3, fig.cap="Syntactic analysis of parents' *no* utterances to children between 1 and 3 years of age."}
ggplot(p_pre_no, aes(bin, fill = no)) +
  geom_bar()+
  xlab("Child Age (months)")+
  ylab("Number of Instances")+
  theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust=1), plot.title = element_text(hjust = 0.5))+
  theme(legend.key=element_blank(), legend.key.size=unit(12,"point"))+
  labs(fill = "Syntactic Position") +
  scale_fill_brewer(palette="Paired")

```

The first utterances of the form NEG+S with an overt subject were produced at 18 months, a full 5 months after the first negative utterances were produced. This does not preclude the possibility of an initial NEG+S stage, because young children’s combinatorial capacity is limited, so it is possible that their simpler utterances were manifestations of an underlying NEG+S structure. However, if this were the case we would expect to have seen an eventual swell in overt NEG+S utterances as children’s utterance lengths increased, followed by a subsequent decrease as children entered Stage 2 and the negation moved to within the sentence. Instead, we saw a steady climb in proportion, reaching adult levels of production around 30 months. This pattern was more consistent with a story in which children’s early negations are often anaphoric– responding to a previous utterance or event– and appear more often before full sentences as a result of children’s increased overall productions of full sentences.


```{r ChildNotSyntaxPlot, fig.env="figure", fig.height= 3, fig.cap="Syntactic analysis of children's *not* utterances between 1 and 3 years of age."}
ggplot(pre_not, aes(bin, fill = not)) +
  geom_bar()+
  xlab("Child Age (months)")+
  ylab("Number of Instances")+
  theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust=1), plot.title = element_text(hjust = 0.5))+
  theme(legend.key=element_blank(), legend.key.size=unit(12,"point"))+
  labs(fill = "Syntactic Position") +
  scale_fill_brewer(palette="Paired")

```

We found further evidence for the anaphoric interpretation of NEG+S utterances in children in the absence of *not* utterances of the form NEG+S (<5% per age bin) or S+NEG (<2% per age bin). According to @klimaBellugi1966’s account, *no* and *not* are initially interchangeable as the NEG element, and occur in both pre- and post- sentential positions. However, we found that only utterances of the form no+S occurred in significant numbers. These observations are inconsistent with a general NEG+S stage, but they are consistent with an anaphoric analysis; anaphoric negation will by nature only appear at the beginning of an utterance, and only *no* is licensed as an anaphoric negator.

These observations do not allow us to unequivocally reject @klimaBellugi1966’s hypothesis of a NEG+S stage, but they do make clear the insufficiency of the current evidence in support of the claim. It is, of course, possible that the entire NEG+S stage begins and ends before children acquire the combinatorial abilities to realize it overtly. If this is the case, it will be impossible to differentiate between pre-sentential negation and constituent or intra-sentential negation using production data, so the question is left for future comprehension work.

Our second focus in this study was the cluster of hypotheses surrounding @klimaBellugi1966’s Stage 2, in which the negator is theorized to move into the (as yet untensed) sentence (NP+NEG+VP), and *can’t* and *don't* are added as unanalyzed wholes to the list of negators, all of which remain interchangeable and infinitival. @schutze2010status pushed back against this last, demonstrating that instances of infinitival negation are actually quite rare, excepting non-agreeing third singular *don't* (eg. “He don’t bite you”). He used these observations as evidence for an account in which *don't* is already at this stage analyzed as AUX+n’t, and agreement errors stem from a missing or underspecified infelection parameter in the lexicon. @thorntonTesan2013 rejected this claim, instead putting forward the hypothesis that *no*, *not*, and *don't* are initially analyzed as adverbial negation, with *don't* added only later as a head form of negation that can show agreement. They provided as evidence for this claim data indicating that children undergo a sharp transition from *not* to *n’t* in their third singular utterances. In Study 2 we attempted to corroborate these data, along with @schutze2010status’s data on non-agreeing *don't*, with mixed success. 

Figure \@ref(fig:Dont) shows the breakdown of children’s uses of *don't* and *doesn't* in third-singular (N = `r nrow(third_sg)`) and non-third-singular (N = `r nrow(other_pos)`) utterances, respectively. Utterances tagged as imperative were removed in order to remain consistent with @schutze2010status, and proper nouns ending in ‘s’ were discounted due to the possibility of being plural or possessive. We found that children often produced non-agreeing *don't* in third-singular contexts, while over-generalizations of *doesn't* were very rare (<2% of utterances). Our data were consistent with the data reported in @schutze2010status, which he took as evidence that children understand *doesn't* as a tensed element, contradicting @klimaBellugi1966’s proposal that *don't* and *doesn't* are initially untensed negative elements when they enter the lexicon during Stage 2. **comment here?**

```{r Dont, fig.env="figure", fig.height= 3, fig.cap="Children's utterances of *don't* and *doesn't* before 3 years of age."}
all_pos <- rbind(third_sg, other_pos)
all_pos$dont <- factor(all_pos$dont, levels = c("don\'t", "doesn\'t"))
all_pos$thirdsg <- factor(all_pos$thirdsg, levels = c("Third-singular Utterances", "Non-third-singular Utterances"))

ggplot(all_pos %>% filter(target_child_age>= 21), aes(bin, fill = dont))+
  geom_bar(position = "fill")+
  xlab("Child Age (months)")+
  ylab("Proportion of Instances")+
  theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust=1), plot.title = element_text(hjust = 0.5))+
  theme(legend.key=element_blank(), legend.key.size=unit(12,"point"))+
  labs(fill = "\'don\'t\' form")+
  scale_fill_brewer(palette = "Paired") +
  facet_grid(~thirdsg)

```


Finally, Figure \@ref(fig:Verb3sg) shows the breakdown of children’s negative third-person utterances by negation type. In the interest of consistency with @thorntonTesan2013, we limited our analysis to cases where the negative element composed with a lexical verb (ie. 3sg pronoun/proper noun + NEG + VP) (N = `r nrow(neg_3sg)`). @thorntonTesan2013 found that that children’s utterances of this form underwent a sharp shift from *not* to *n't* negation, which they took as evidence for a shift from adverbial negation to syntactic negation. Contrary to these results, we found constant, relatively high levels of *n't* utterances (>60% ) and constant, relatively low levels of *no* (<7%) and *not*(<31%) utterances **(comment on theoretical import?)**. It is worth noting that the data cited in @thorntonTesan2013 were the result of a longitudinal elicitation study; it is possible that some task-specific element of that study led to the stark difference between our data and theirs, and further study will be required to determine the source of the difference. 

```{r Verb3sg, fig.cap="Breakdown of children's negative utterances after a third singular subject (and composed with a lexical verb) between 1 and 3 years of age.", fig.env="figure", fig.height=3}
ggplot(neg_3sg, 
       aes(bin, y = ..count../tapply(..count.., ..x.. ,sum)[..x..], color = neg, shape = neg, linetype = neg, group = neg))+
  geom_point(stat = "count")+
  geom_line( stat = "count")+
  xlab("Child Age (months)")+
  ylab("Proportion of Instances")+
  theme(axis.text.x = element_text(angle = 70, vjust = 1, hjust=1), plot.title = element_text(hjust = 0.5))+
  theme(legend.key=element_blank(), legend.key.size=unit(12,"point"))+
  labs(color = "Negative Morpheme", linetype = "Negative Morpheme", shape = "Negative Morpheme")+
  scale_fill_brewer(palette = "Paired")

```

One caveat with the traditional *NP+VP* approach, as mentioned above, is that it makes the assumption that the negator falls out of the range of the sentence *S*, and it is not straightforward to define a clear boundary of the VP or the NP. On the other hand, if the negator is a modifier at the sentential level, in turn this indicates that the negator is modifying the main verb of the sentence. Therefore instead of looking at the relative position of the negator to the (presumed) span of *VP*, a more fine-grained approach is to examine instead the relative position of the negator to just the main verb. With this alternative approach, we take advantage of the available syntactic dependency annotations in the English-NA and the English-UK sections of CHILDES. Since the current version of childesr [@sanchez2019childes] does not contain annotations of syntactic dependencies, we developed in-house scripts to directly extracted syntactically annotated utterances from the original xml formatted files in CHILDEs, using the programming language python. We restricted our analyses to *full utterances*, that is, utterances that contain: (1) a verbal root with a POS tag as *v* that indicates verbs and a dependency relation as *root*, which indicates that this verb is the head of the utterance; (2) a subject token whose syntactic dependency relation with the verbal root is 'SUBJ'. This resulted in a number of X full utterances extracted from the corpus. This led to 207,962 full utterances produced by children and 406,242 full utterances produced by the parents.

Given these full utterances, we extracted cases with negators in two different ways. First one simply selected all utterances that contain *no*, *n't* and *not*, regardless of their syntactic dependency relation with the verbal root. This led to a total of Y negative utterances. Second one restricted to utterances where the negator directly modifies the verbal root (a direct child of the root of the utterance), or cases where the negator modifies an auxiliary or modal verb that directly modifies the verbal root (i.e. the auxiliary is the direct child of the root of the utterance with a dependency relation *AUX*; *I don't like this one*). This led to a total of Z negative utterances. 

We binned these utterances based the speaker role, the child or the parent. Each utterance was tagged with three additional pieces of information: (1) the age of the child; (2) the negator(s) that the utterance contains; (3) the relative position of the negator to the verbal root and the subject of the utterance; it was tagged as *pre* if the negator occurs before the head of the subject and the verbal root, *inter* if the negator occurs between the head of the subject and the verbal root, and *post* if the negator occurs after the verbal root. Then for each speaker role, we first computed the total number of utterances for each negator, then calculated the proportion of negator at different ages. For instance, if the production of children contains 100 utterances with *no* in total, among which 10 was produced at the age of 24 months, 60  was produced at 40 months, and 30 was produced at 60 months, the proportions of *no* at the three different ages for children would be 10%, 60% and 30% respectively.


```{r load data}
study2_no <- read.csv('processed_data/study2_no.csv', header = T, sep = ',')
study2_no_child <- subset(study2_no, Role %in% c("Target_Child") & Feature %in% c("Pre", "Inter", "Post"))
study2_no_parent <- subset(study2_no, Role %in% c("Parent") & Feature %in% c("Pre", "Inter", "Post"))
study2_no_child_annotation <- subset(study2_no, Role %in% c("Target_Child") & Feature %in% c("Pre_annotation", "Inter_annotation", "Post_annotation"))
study2_no_parent_annotation <- subset(study2_no, Role %in% c("Parent") & Feature %in% c("Pre_annotation", "Inter_annotation", "Post_annotation"))

```

```{r study2_no_child, fig.cap="The relative position of no in child production.", fig.env="figure", fig.height=8}

p1 <- ggplot(study2_no_child, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Dark2") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Child no, Without annotation of negation marker')


p2 <- ggplot(study2_no_child_annotation, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Paired") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Chid no, With annotation of negation marker')

p_child <- grid.arrange(p1, p2, ncol=1, nrow=2)

```

```{r study2_no_parent, fig.cap="The relative position of no in parent production.", fig.env="figure", fig.height=8}

p3 <- ggplot(study2_no_parent, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Dark2") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Parent no, Without annotation of negation marker')


p4 <- ggplot(study2_no_child_annotation, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Paired") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Parent no, With annotation of negation marker')

p_parent <- grid.arrange(p3, p4, ncol=1, nrow=2)

```

Comparing Figure \@ref(fig:study2_no_child) and Figure \@ref(fig:study_2_no_parent), it can be seen that regardless of the particular speaker role, the production of *no* before the subject of the sentence is the most prevalent. Although there was no strong difference between children's production of *no* when it occurs inbetween the subject and the head verb of the sentence, and their production when *no* appears after the head verb. The results do not seem to be dependent on whether *no* bares any direct syntactic dependency relation with the head verb
By contrast, both *nt* and *not* occurs more frequently between the subject and the head verb. The findings for these two negators do not seem to be restricted to the particular annotation scheme neither. Across the three different negators considered here, children's production appears to be more adult-like around 26 months. Most of the negators, driven by the high frequency of *no*, occurs before the subject in the sentence-initial position.

```{r load data}
study2_nt <- read.csv('processed_data/study2_nt.csv', header = T, sep = ',')
study2_nt_child <- subset(study2_nt, Role %in% c("Target_Child") & Feature %in% c("Pre", "Inter", "Post"))
study2_nt_parent <- subset(study2_nt, Role %in% c("Parent") & Feature %in% c("Pre", "Inter", "Post"))
study2_nt_child_annotation <- subset(study2_nt, Role %in% c("Target_Child") & Feature %in% c("Pre_annotation", "Inter_annotation", "Post_annotation"))
study2_nt_parent_annotation <- subset(study2_nt, Role %in% c("Parent") & Feature %in% c("Pre_annotation", "Inter_annotation", "Post_annotation"))

```

```{r study2_nt_child, fig.cap="The relative position of n't in child production.", fig.env="figure", fig.height=8}

p1 <- ggplot(study2_nt_child, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Dark2") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Child nt, Without annotation of negation marker')


p2 <- ggplot(study2_nt_child_annotation, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Paired") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Child nt, With annotation of negation marker')

p_child <- grid.arrange(p1, p2, ncol=1, nrow=2)

```

```{r study2_nt_parent, fig.cap="The relative position of n't in parent production.", fig.env="figure", fig.height=8}

p3 <- ggplot(study2_nt_parent, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Dark2") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Parent nt, Without annotation of negation marker')


p4 <- ggplot(study2_nt_child_annotation, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Paired") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Parent nt, With annotation of negation marker')

p_parent <- grid.arrange(p3, p4, ncol=1, nrow=2)

```


```{r load data}
study2_not <- read.csv('processed_data/study2_not.csv', header = T, sep = ',')
study2_not_child <- subset(study2_not, Role %in% c("Target_Child") & Feature %in% c("Pre", "Inter", "Post"))
study2_not_parent <- subset(study2_not, Role %in% c("Parent") & Feature %in% c("Pre", "Inter", "Post"))
study2_not_child_annotation <- subset(study2_not, Role %in% c("Target_Child") & Feature %in% c("Pre_annotation", "Inter_annotation", "Post_annotation"))
study2_not_parent_annotation <- subset(study2_not, Role %in% c("Parent") & Feature %in% c("Pre_annotation", "Inter_annotation", "Post_annotation"))

```

```{r study2_not_child, fig.cap="The relative position of not in child production.", fig.env="figure", fig.height=8}

p1 <- ggplot(study2_not_child, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Dark2") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Child not, Without annotation of negation marker')


p2 <- ggplot(study2_not_child_annotation, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Paired") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Child not, With annotation of negation marker')

p_child <- grid.arrange(p1, p2, ncol=1, nrow=2)

```

```{r study2_not_parent, fig.cap="The relative position of not in parent production.", fig.env="figure", fig.height=8}

p3 <- ggplot(study2_not_parent, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Dark2") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Parent not, Without annotation of negation marker')


p4 <- ggplot(study2_not_child_annotation, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Paired") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Parent not, With annotation of negation marker')

p_parent <- grid.arrange(p3, p4, ncol=1, nrow=2)

```

```{r load data}
study2_all <- read.csv('processed_data/study2_all.csv', header = T, sep = ',')
study2_all_child <- subset(study2_all, Role %in% c("Target_Child") & Feature %in% c("Pre", "Inter", "Post"))
study2_all_parent <- subset(study2_all, Role %in% c("Parent") & Feature %in% c("Pre", "Inter", "Post"))
study2_all_child_annotation <- subset(study2_all, Role %in% c("Target_Child") & Feature %in% c("Pre_annotation", "Inter_annotation", "Post_annotation"))
study2_all_parent_annotation <- subset(study2_all, Role %in% c("Parent") & Feature %in% c("Pre_annotation", "Inter_annotation", "Post_annotation"))

```

```{r study2_child, fig.cap="The relative position of all negators in child production.", fig.env="figure", fig.height=8}

p1 <- ggplot(study2_all_child, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Dark2") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Child negators, Without annotation of negation marker')


p2 <- ggplot(study2_all_child_annotation, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Paired") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Child negators, With annotation of negation marker')

p_child <- grid.arrange(p1, p2, ncol=1, nrow=2)

```

```{r study2_parent, fig.cap="The relative position of all negators in parent production.", fig.env="figure", fig.height=8}

p3 <- ggplot(study2_all_parent, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Dark2") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Parent negators, Without annotation of negation marker')


p4 <- ggplot(study2_all_parent_annotation, aes(x = Age, y = Mean, color = Feature)) + 
  geom_pointrange(aes(ymax = CI975, ymin = CI25), position=position_dodge(.9)) +
  scale_color_brewer(palette="Paired") +
  labs(x = 'Age') +
  labs(y = 'Percent (%)') +
  labs(color = 'Syntactic Position') +
  theme(text = element_text(size = 20),
        legend.position = 'top') +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  ggtitle('Parent negators, With annotation of negation marker')

p_parent <- grid.arrange(p3, p4, ncol=1, nrow=2)

```

## Conclusions

The results of Study 2 indicate that, while children do produce a number of utterances of the form NEG+S/S+NEG, as proposed in @klimaBellugi1966’s Stage 1, the vast majority of these utterances are of the form no+S. Instances of this form do not swell early and then dissipate, as would be expected of an early stage of production, but rather are initially infrequent and slowly climb to adult levels. We join @bloom1970 and @wode1977four in proposing that these observations are more consistent with an analysis of no+S utterances as anaphoric, with the negative element negating a previous event or statement. 

In addition, the results of Study 2 corroborated @schutze2010status’s observation that children’s agreement errors with utterances containing *don't*/*doesn't* were largely due to over-generalization of *don't* to third-singular cases. @schutze2010status took these results as evidence against *don't* and *doesn't* as unanalyzed wholes during @klimaBellugi1966’s Stage 2. **theoretical import?**

Finally, Study 2 failed to confirm @thorntonTesan2013’s observation that the negative element in children’s third-singular utterances undergoes a sharp shift from *not* to *n’t*. Instead, we found relatively constant levels of each negator throughout, with the vast majority of utterances using *n’t*. We conclude that further study will be necessary to determine the reason for this difference, and to evaluate the hypothesis that children’s negations undergo a shift from adverbial to syntactic head, which would corroborate @klimaBellugi1966’s proposal that in Stage 2 the NEG element consists of *no*, *not*, *can’t*, and *don't*, all of which are interchangeable and untensed. 

# Study 3: Early Syntactic Structures for Negation

In this study we ask what syntactic analyses can be attributed to children's early negative utterances. We also ask what common syntactic structures are present in parents' speech. The goal is to provide an account of children's syntactic development in the spirit of @klimaBellugi1966's pioneering work with data and computational tools available today.

## Method

Specifically, we ask what are the syntactic functions of different negators, what are the common syntactic categories that these negators modify, and how these patterns differ between production of children and that of the parent. We considered the particular syntactic function of a negator here as being indicated by the syntactic dependency relation between the negator and its syntactic head. And we considered the syntactic category that a negator modifies as being indicated by the POS tag of the negator's syntactic head. 

To do this, we again used the English-North America and English-UK collections of corpora from CHILDES [@macwhinney2000childes], focusing on data with available syntactic parses. Preprocessing led to a total of 3,987,829 syntactically annotated utterances, with 
1,930,041 from the English-NA section, and 2,057,788 from the English-UK section. We extracted all utterances that contain any of the three negators, *no*, *not*, and *n't*, regardless of whether the utterance is a *full utterance* as defined in study 2. Utterances with just one token (excluding punctuation; e.g. *no !*) were removed. Cases that contain one negator where the negator is also the root of the utterance were also not excluded. This resulted in a total of U utterances. 

We grouped all utterances based on the speaker role, either the child or the parent. Each utterance was further tagged with four pieces of information: (1) the age of the child; (2) the negator that the utterance contains; (3) the syntactic dependency between the negator and its head; (4) the POS tag of the negator's syntactic head. We describe our analyses of each negator below.

## Results

For *no*, we first calculated the proportions of its different syntactic functions, as well as the proportions of the different POS tags of its syntactic head. As shown in Figure \@ref(fig:noFunction), the most common dependency relation that *no* bares include:
(1) *COM*, which supposedly represents a sentence-medial communicator (e.g. *ah, no*);
(2) *QUANT*, which refers to a nominal quantifier (e.g. *no checkers*);
(3) *ENUM*, which denotes enumeration of a series of items that are not combined explicitly within a coordination structure or a conjunction. 
The overall production of *no* serving these syntactic functions is comparable between children and parents.

With that being said, the differences between *no* as a communicator versus *no* as an enumerator are not straightforward. Our manual inspection of the utterances revealed that *no* is not only used in a sentence-medial position when serving as a communicator (e.g. *no I gave you the list*), and that in certain cases such *no no no I got it*, where the last *no* should be annotated as an enumerator, it is not exactly clear whether and how the syntactic functions of the three *no* are distinct, besides that they possibly share similar discourse function, i.e. functioning as the response variable to the previous utterance in the interactions. For example, consider the following interactions observed from the data.
(1) Mother: did you see the truck
    Child: no I see truck (Adam from the Brown Corpus)
(2) Father: how about you make a little thing okay (Roman from the Weist Corpus)
    Child: no no no I wanna make two big things
(3) Father: did it happen today
    Child: no no no I got it at school Friday (Abe from the Kuczaj Corpus)
Therefore we combined cases where *no* has a dependency relation of *COM* and *ENUM* together for further analyses, and we refer to the syntactic function of *no* in these cases as the *discourse response variable* (*Anaphoric??*).


```{r load data}
no <- read.csv('processed_data/study3_no.csv', header = T, sep = ',')
no_child <- subset(no, Role %in% c('Target_Child'))
no_parent <- subset(no, Role %in% c('Parent'))

no_child_function <- data.frame(table(no_child$Negation_dep))
names(no_child_function) <- c('Dependency', 'Frequency')
no_child_function$Dependency <- reorder(no_child_function$Dependency, -no_child_function$Frequency)
no_child_function$Proportion <- no_child_function$Frequency * 100 / sum(no_child_function$Frequency)
no_child_function$Role <- as.vector(rep('Target_Child', nrow(no_child_function)))

no_parent_function <- data.frame(table(no_parent$Negation_dep))
names(no_parent_function) <- c('Dependency', 'Frequency')
no_parent_function$Dependency <- reorder(no_parent_function$Dependency, -no_parent_function$Frequency)
no_parent_function$Proportion <- no_parent_function$Frequency * 100 / sum(no_parent_function$Frequency)
no_parent_function$Role <- as.vector(rep('Parent', nrow(no_parent_function)))

no_function <- rbind(no_child_function, no_parent_function)

```

```{r noFunction, fig.cap="Comparing the syntactic function of no between children and parent.", fig.env="figure", fig.height=6}
ggplot(no_function, aes(x=Dependency, y=Proportion, fill=Role))+ 
  geom_bar(position=position_dodge(),stat='identity')+
  scale_fill_manual(values=c("#0072B2", "#CC79A7"))+
  labs(x="Syntactic function (dependency relation)")+
  labs(y="Proportion (%)")+
  scale_y_continuous(limits=c(0,100))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top")

```

To compare the production of *no* as a discourse response variable between children and parents, we calculated the proportion of cases where *no* serves as *COM* or *ENUM* by the age of the child. As presented in Figure \@ref{fig:noCommunicatorAge}, while parents have been articulating *no* with this particular function since the child was as young as 7 months old, children did not start at least more regularly produce this negator until the age of 20 months. The frequency of the production of *no* by children is gradually becoming comparable to that of the parents around the age of 23 months.


```{r load data}
no_child_communicator <- subset(no_child, Negation_dep %in% c('COM', 'ENUM'))
no_child_communicator$dep <- as.vector(rep('COMMUNICATOR', nrow(no_child_communicator)))
no_child_communicator_age <- aggregate(data.frame(no_child_communicator$dep), by=list(no_child_communicator$Age),FUN=length)
names(no_child_communicator_age) <- c('Age', 'Frequency')
no_child_communicator_age$Proportion <- no_child_communicator_age$Frequency * 100 / sum(no_child_communicator_age$Frequency)
no_child_communicator_age$Role <- as.vector(rep('Target_Child', nrow(no_child_communicator_age)))

no_parent_communicator <- subset(no_parent, Negation_dep %in% c('COM', 'ENUM'))
no_parent_communicator$dep <- as.vector(rep('COMMUNICATOR', nrow(no_parent_communicator)))
no_parent_communicator_age <- aggregate(data.frame(no_parent_communicator$dep), by=list(no_parent_communicator$Age),FUN=length)
names(no_parent_communicator_age) <- c('Age', 'Frequency')
no_parent_communicator_age$Proportion <- no_parent_communicator_age$Frequency * 100 / sum(no_parent_communicator_age$Frequency)
no_parent_communicator_age$Role <- as.vector(rep('Parent', nrow(no_parent_communicator_age)))

no_communicator_age <- rbind(no_child_communicator_age, no_parent_communicator_age)

```


```{r noCommunicatorAge, fig.cap="Comparing the trajectory of no as a discourse response variable between children and parent.", fig.env="figure", fig.height=6}
ggplot(no_communicator_age, aes(x=Age, y=Proportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top")
```

Besides *COM* and *ENUM*, we also analyzed utterances in which *no* served as a quantifier. For each speaker role, we calculated the proportions of instances that contain *no* as a quantifier given different ages of the children. As shown in Figure \@ref{fig:noQUANTAge}, parents' usage of *no* as a quantifier precedes that of the children.
Children did not start using *no* with this particular syntactic function until around the age of 18; their production gradually becomes comparable to that of the parents at about 23 months. These findings are similar to the production of *no* as a discourse response variable presented in Figure \@ref{fig:noCommunicatorAge}.

```{r load data}
no_child_quantifier <- subset(no_child, Negation_dep %in% c('QUANT'))
no_child_quantifier$dep <- as.vector(rep('quantifier', nrow(no_child_quantifier)))
no_child_quantifier_age <- aggregate(data.frame(no_child_quantifier$dep), by=list(no_child_quantifier$Age),FUN=length)
names(no_child_quantifier_age) <- c('Age', 'Frequency')
no_child_quantifier_age$Proportion <- no_child_quantifier_age$Frequency * 100 / sum(no_child_quantifier_age$Frequency)
no_child_quantifier_age$Role <- as.vector(rep('Target_Child', nrow(no_child_quantifier_age)))

no_parent_quantifier <- subset(no_parent, Negation_dep %in% c('COM', 'ENUM'))
no_parent_quantifier$dep <- as.vector(rep('quantifier', nrow(no_parent_quantifier)))
no_parent_quantifier_age <- aggregate(data.frame(no_parent_quantifier$dep), by=list(no_parent_quantifier$Age),FUN=length)
names(no_parent_quantifier_age) <- c('Age', 'Frequency')
no_parent_quantifier_age$Proportion <- no_parent_quantifier_age$Frequency * 100 / sum(no_parent_quantifier_age$Frequency)
no_parent_quantifier_age$Role <- as.vector(rep('Parent', nrow(no_parent_quantifier_age)))

no_quantifier_age <- rbind(no_child_quantifier_age, no_parent_quantifier_age)

```


```{r noQUANTAge, fig.cap="Comparing the trajectory of no as a quantifier between children and parent.", fig.env="figure", fig.height=6}
ggplot(no_quantifier_age, aes(x=Age, y=Proportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top")
```

Taking a closer look at the usage of *no* as a quantifier, we examined the POS tags of its syntactic head to answer the question of *what does no quantify*? Again for each speaker role, the proportions of the different POS tags were calculated. Based on results from Figure \@ref{fig:noQuantifierPos}, the most frequent syntactic categories that *no* quantifies are as follows:
(1) *n*, which refers to nouns (e.g. *this is no time to go..*; *there's no snow out there*);
(2) *pro*, which refers to pronouns (e.g. *no this one*; *no the other one*);
(3) *adj*, which refers to adjectives (e.g. *no red*; *no big* ).
The overall production of *no* is comparable between children and parents within each of these syntactic categories.


```{r load data}
no_child_quantifier <- subset(no_child, Negation_dep %in% c('QUANT'))
no_child_quantifier_pos <- data.frame(table(no_child_quantifier$Head_POS))
names(no_child_quantifier_pos) <- c('POS', 'Frequency')
no_child_quantifier_pos$POS <- reorder(no_child_quantifier_pos$POS, -no_child_quantifier_pos$Frequency)
no_child_quantifier_pos$Proportion <- no_child_quantifier_pos$Frequency * 100 / sum(no_child_quantifier_pos$Frequency)
no_child_quantifier_pos$Role <- as.vector(rep('Target_Child', nrow(no_child_quantifier_pos)))

no_parent_quantifier <- subset(no_parent, Negation_dep %in% c('QUANT'))
no_parent_quantifier_pos <- data.frame(table(no_parent_quantifier$Head_POS))
names(no_parent_quantifier_pos) <- c('POS', 'Frequency')
no_parent_quantifier_pos$POS <- reorder(no_parent_quantifier_pos$POS, -no_parent_quantifier_pos$Frequency)
no_parent_quantifier_pos$Proportion <- no_parent_quantifier_pos$Frequency * 100 / sum(no_parent_quantifier_pos$Frequency)
no_parent_quantifier_pos$Role <- as.vector(rep('Parent', nrow(no_parent_quantifier_pos)))

no_quantifier_pos <- rbind(no_child_quantifier_pos, no_parent_quantifier_pos)

```

```{r noQuantifierPos, fig.cap="Comparing the syntactic function of no between children and parent.", fig.env="figure", fig.height=6}
ggplot(no_quantifier_pos, aes(x=POS, y=Proportion, fill=Role))+ 
  geom_bar(position=position_dodge(),stat='identity')+
  scale_fill_manual(values=c("#0072B2", "#CC79A7"))+
  labs(x="POS tags")+
  labs(y="Proportion (%)")+
  scale_y_continuous(limits=c(0,100))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top")

```

We then continued to examine the production of *no* as a quantifier given its most frequent syntactic heads. We focus specifically on cases when the syntactic head of *no* is either a noun or a pronoun, since the numbers of these cases are large enough to yield reliable estimates. In children's production, there are 5,455 utterances where *no* modifies a noun, and 1,100 cases where *no* modifies a pronoun. In parent's production, there are 5,823 utterances where *no* modifies a noun, and 1,018 instances where *no* modifies a pronoun. Results from Figure \@ref{fig:noQUANTnAge} and FIgure \@ref{fig:noQUANTproAge} are comparable to each other as well as comparble to cases when *no* was used as a discourse response variable. Parents' usage of *no* as a quantifier modifying a noun or a pronoun is earlier than that of children. On the other hand, children starts using *no* to quantify nouns or pronouns after around 18 months old; their production starts to bare syntactic resemblance to that of parents around the age of 22 months.

```{r load data}
no_child_quantifier_n <- subset(no_child, Negation_dep %in% c('QUANT') & Head_POS %in% c('n'))
no_child_quantifier_n$dep <- as.vector(rep('quantifier', nrow(no_child_quantifier_n)))
no_child_quantifier_n_age <- aggregate(data.frame(no_child_quantifier_n$dep), by=list(no_child_quantifier_n$Age),FUN=length)
names(no_child_quantifier_n_age) <- c('Age', 'Frequency')
no_child_quantifier_n_age$Proportion <- no_child_quantifier_n_age$Frequency * 100 / sum(no_child_quantifier_n_age$Frequency)
no_child_quantifier_n_age$Role <- as.vector(rep('Target_Child', nrow(no_child_quantifier_n_age)))

no_parent_quantifier_n <- subset(no_parent, Negation_dep %in% c('QUANT') & Head_POS %in% c('n'))
no_parent_quantifier_n$dep <- as.vector(rep('quantifier', nrow(no_parent_quantifier_n)))
no_parent_quantifier_n_age <- aggregate(data.frame(no_parent_quantifier_n$dep), by=list(no_parent_quantifier_n$Age),FUN=length)
names(no_parent_quantifier_n_age) <- c('Age', 'Frequency')
no_parent_quantifier_n_age$Proportion <- no_parent_quantifier_n_age$Frequency * 100 / sum(no_parent_quantifier_n_age$Frequency)
no_parent_quantifier_n_age$Role <- as.vector(rep('Parent', nrow(no_parent_quantifier_n_age)))

no_quantifier_n_age <- rbind(no_child_quantifier_n_age, no_parent_quantifier_n_age)

```


```{r noQUANTnAge, fig.cap="Comparing the trajectory of no as a quantifier of nouns between children and parent.", fig.env="figure", fig.height=6}
ggplot(no_quantifier_n_age, aes(x=Age, y=Proportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top")
```

```{r load data}
no_child_quantifier_pro <- subset(no_child, Negation_dep %in% c('QUANT') & Head_POS %in% c('pro'))
no_child_quantifier_pro$dep <- as.vector(rep('quantifier', nrow(no_child_quantifier_pro)))
no_child_quantifier_pro_age <- aggregate(data.frame(no_child_quantifier_pro$dep), by=list(no_child_quantifier_pro$Age),FUN=length)
names(no_child_quantifier_pro_age) <- c('Age', 'Frequency')
no_child_quantifier_pro_age$Proportion <- no_child_quantifier_pro_age$Frequency * 100 / sum(no_child_quantifier_pro_age$Frequency)
no_child_quantifier_pro_age$Role <- as.vector(rep('Target_Child', nrow(no_child_quantifier_pro_age)))

no_parent_quantifier_pro <- subset(no_parent, Negation_dep %in% c('QUANT') & Head_POS %in% c('pro'))
no_parent_quantifier_pro$dep <- as.vector(rep('quantifier', nrow(no_parent_quantifier_pro)))
no_parent_quantifier_pro_age <- aggregate(data.frame(no_parent_quantifier_pro$dep), by=list(no_parent_quantifier_pro$Age),FUN=length)
names(no_parent_quantifier_pro_age) <- c('Age', 'Frequency')
no_parent_quantifier_pro_age$Proportion <- no_parent_quantifier_pro_age$Frequency * 100 / sum(no_parent_quantifier_pro_age$Frequency)
no_parent_quantifier_pro_age$Role <- as.vector(rep('Parent', nrow(no_parent_quantifier_pro_age)))

no_quantifier_pro_age <- rbind(no_child_quantifier_pro_age, no_parent_quantifier_pro_age)

```


```{r noQUANTproAge, fig.cap="Comparing the trajectory of no as a quantifier of pronouns between children and parent.", fig.env="figure", fig.height=6}
ggplot(no_quantifier_pro_age, aes(x=Age, y=Proportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top")
```

Now we turn to *n't*. The linguistic items that *n't* could be combined with is much more restrictive in comparison to *no* and *not*, in the sense that it mostly co-occurs with auxiliary or copula verbs. Therefore we focus on the syntactic analyses to what these auxiliary and copula verbs are that appear with *n't*. 

Comparing child and parent production, the patterns are overall comparable. The most frequent syntactic head that *n't* modifies is the auxiliary verb *do*, regardless of the speaker role. While parents tend to associate *n't* more frequently with the copula verb *be* than the auxiliary *can*, our results from Figure \@ref{fig:study3_nt} show the reversed pattern in children's production.

```{r load data}
nt <- subset(read.csv('processed_data/study3_nt.csv', header = T, sep = ','), Head_dep %in% c('AUX') | Head_POS %in% c('cop'))
nt_child <- subset(nt, Role %in% c('Target_Child'))
nt_parent <- subset(nt, Role %in% c('Parent'))

for (i in 1:nrow(nt_child)) {
  if (grepl("doesn't", as.vector(nt_child$Utterance)[i]) & as.vector(nt_child$Head_lexical)[i] %in% c('do')) {
#    child_does = child_does + 1
    nt_child$Head_lexical[i] <- "does"
  }
}

nt_child_lexical <- data.frame(table(nt_child$Head_lexical))
names(nt_child_lexical) <- c('Lexical', 'Frequency')
nt_child_lexical$Lexical <- reorder(nt_child_lexical$Lexical, -nt_child_lexical$Frequency)
nt_child_lexical$Proportion <- nt_child_lexical$Frequency * 100 / sum(nt_child_lexical$Frequency)
nt_child_lexical$Role <- as.vector(rep('Target_Child', nrow(nt_child_lexical)))

for (i in 1:nrow(nt_parent)) {
  if (grepl("doesn't", as.vector(nt_parent$Utterance)[i]) & as.vector(nt_parent$Head_lexical)[i] %in% c('do')) {
    nt_parent$Head_lexical[i] <- "does"
  }
}

nt_parent_lexical <- data.frame(table(nt_parent$Head_lexical))
names(nt_parent_lexical) <- c('Lexical', 'Frequency')
nt_parent_lexical$Lexical <- reorder(nt_parent_lexical$Lexical, -nt_parent_lexical$Frequency)
nt_parent_lexical$Proportion <- nt_parent_lexical$Frequency * 100 / sum(nt_parent_lexical$Frequency)
nt_parent_lexical$Role <- as.vector(rep('Parent', nrow(nt_parent_lexical)))
nt_parent_lexical <- subset(nt_parent_lexical, !(Lexical %in% c('look', 'stay')))


nt_lexical <- rbind(nt_child_lexical, nt_parent_lexical)

```

```{r study3_nt, fig.cap="Comparing the syntactic function of nt between children and parent.", fig.env="figure", fig.height=6}
ggplot(nt_lexical, aes(x=Lexical, y=Proportion, fill=Role))+ 
  geom_bar(position=position_dodge(),stat='identity')+
  scale_fill_manual(values=c("#0072B2", "#CC79A7"))+
  labs(x="Syntactic head")+
  labs(y="Proportion (%)")+
  scale_y_continuous(limits=c(0,100))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top")

```

We took a further look at the trajectory of children's and parents' production of *n't* when it is modifying an auxiliary or a copula verb. In particular, we focused on five most frequent syntactic heads of *n't*: *do*, *can*, *be*, *does*, *will*, *have*. As shown in Figure \@ref{fig:ntMOST}, considering the five syntactic heads together, in comparison to the parents, children start using *n't* as a modifier of these auxiliary or copula verbs around the age of 20 months, then gradually reach adult-like level around 32 - 34 months with regards to the proportion that *n't* is used in these cases, and eventually use *n't* more frequently than parents at around 36 - 38 months old. Our examinations of individual syntactic head, in particular *do* and *can* revealed similar patterns to the results in Figure \@ref{fig:ntMOST}.


```{r load data}
nt_child_most <- subset(nt_child, Head_lexical %in% c('do', 'can', 'be', 'does', 'will', 'have'))
nt_child_most$lexical <- as.vector(rep('lexical', nrow(nt_child_most)))
nt_child_most_age <- aggregate(data.frame(nt_child_most$lexical), by=list(nt_child_most$Age),FUN=length)
names(nt_child_most_age) <- c('Age', 'Frequency')
nt_child_most_age$Proportion <- nt_child_most_age$Frequency * 100 / sum(nt_child_most_age$Frequency)
nt_child_most_age$Role <- as.vector(rep('Target_Child', nrow(nt_child_most_age)))

nt_parent_most <- subset(nt_parent, Head_lexical %in% c('do', 'can', 'be', 'does', 'will', 'have'))
nt_parent_most$lexical <- as.vector(rep('lexical', nrow(nt_parent_most)))
nt_parent_most_age <- aggregate(data.frame(nt_parent_most$Head_lexical), by=list(nt_parent_most$Age),FUN=length)
names(nt_parent_most_age) <- c('Age', 'Frequency')
nt_parent_most_age$Proportion <- nt_parent_most_age$Frequency * 100 / sum(nt_parent_most_age$Frequency)
nt_parent_most_age$Role <- as.vector(rep('Parent', nrow(nt_parent_most_age)))

nt_most_age <- rbind(nt_child_most_age, nt_parent_most_age)

```


```{r ntMOST, fig.cap="Comparing the trajectory of nt as a modifier between children and parent.", fig.env="figure", fig.height=6}
ggplot(nt_most_age, aes(x=Age, y=Proportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top") +
  ggtitle("do, can, be, does, will and have + n't")

```

```{r load data}
nt_child_do <- subset(nt_child, Head_lexical %in% c('do'))
nt_child_do_age <- aggregate(data.frame(nt_child_do$Head_lexical), by=list(nt_child_do$Age),FUN=length)
names(nt_child_do_age) <- c('Age', 'Frequency')
nt_child_do_age$Proportion <- nt_child_do_age$Frequency * 100 / sum(nt_child_do_age$Frequency)
nt_child_do_age$Role <- as.vector(rep('Target_Child', nrow(nt_child_do_age)))

nt_parent_do <- subset(nt_parent, Head_lexical %in% c('do'))
nt_parent_do_age <- aggregate(data.frame(nt_parent_do$Head_lexical), by=list(nt_parent_do$Age),FUN=length)
names(nt_parent_do_age) <- c('Age', 'Frequency')
nt_parent_do_age$Proportion <- nt_parent_do_age$Frequency * 100 / sum(nt_parent_do_age$Frequency)
nt_parent_do_age$Role <- as.vector(rep('Parent', nrow(nt_parent_do_age)))

nt_do_age <- rbind(nt_child_do_age, nt_parent_do_age)

```


```{r ntDO, fig.cap="Comparing the trajectory of nt modifying do, between children and parent.", fig.env="figure", fig.height=6}
ggplot(nt_do_age, aes(x=Age, y=Proportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top") +
  ggtitle("do + n't")

```

```{r load data}
nt_child_can <- subset(nt_child, Head_lexical %in% c('can'))
nt_child_can_age <- aggregate(data.frame(nt_child_can$Head_lexical), by=list(nt_child_can$Age),FUN=length)
names(nt_child_can_age) <- c('Age', 'Frequency')
nt_child_can_age$Proportion <- nt_child_can_age$Frequency * 100 / sum(nt_child_can_age$Frequency)
nt_child_can_age$Role <- as.vector(rep('Target_Child', nrow(nt_child_can_age)))

nt_parent_can <- subset(nt_parent, Head_lexical %in% c('can'))
nt_parent_can_age <- aggregate(data.frame(nt_parent_can$Head_lexical), by=list(nt_parent_can$Age),FUN=length)
names(nt_parent_can_age) <- c('Age', 'Frequency')
nt_parent_can_age$Proportion <- nt_parent_can_age$Frequency * 100 / sum(nt_parent_can_age$Frequency)
nt_parent_can_age$Role <- as.vector(rep('Parent', nrow(nt_parent_can_age)))

nt_can_age <- rbind(nt_child_can_age, nt_parent_can_age)

```


```{r ntCAN, fig.cap="Comparing the trajectory of nt modifying can, between children and parent.", fig.env="figure", fig.height=6}
ggplot(nt_can_age, aes(x=Age, y=Proportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top") +
  ggtitle("can + n't")

```

```{r load data}
nt_child_be <- subset(nt_child, Head_lexical %in% c('be'))
nt_child_be_age <- aggregate(data.frame(nt_child_be$Head_lexical), by=list(nt_child_be$Age),FUN=length)
names(nt_child_be_age) <- c('Age', 'Frequency')
nt_child_be_age$Proportion <- nt_child_be_age$Frequency * 100 / sum(nt_child_be_age$Frequency)
nt_child_be_age$Role <- as.vector(rep('Target_Child', nrow(nt_child_be_age)))

nt_parent_be <- subset(nt_parent, Head_lexical %in% c('be'))
nt_parent_be_age <- aggregate(data.frame(nt_parent_be$Head_lexical), by=list(nt_parent_be$Age),FUN=length)
names(nt_parent_be_age) <- c('Age', 'Frequency')
nt_parent_be_age$Proportion <- nt_parent_be_age$Frequency * 100 / sum(nt_parent_be_age$Frequency)
nt_parent_be_age$Role <- as.vector(rep('Parent', nrow(nt_parent_be_age)))

nt_be_age <- rbind(nt_child_be_age, nt_parent_be_age)

```


```{r ntBE, fig.cap="Comparing the trajectory of nt modifying be, between children and parent.", fig.env="figure", fig.height=6}
ggplot(nt_be_age, aes(x=Age, y=Proportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top") +
  ggtitle("be + n't")

```

Finally, we moved on to *not*. Our syntactic analyses of *not* followed a similar procedure as that for *no*. First we analyzed the distributions of the dependency relations between *not* and its syntactic heads between child and parent production. As presented in Figure \@ref{fig:notFunction}, the distribution of the syntactic heads of *not* is quite restricted; in almost all cases *not* serves as a negator modifier of its syntactic head, with no observable differencess between whether the speaker is the child or the parent.

```{r load data}
study3_not <- read.csv('processed_data/study3_not.csv', header = T, sep = ',')
for (i in 1:nrow(study3_not)) {
  if (as.vector(study3_not$Head_lexical)[i] %in% c('be') & as.vector(study3_not$Head_POS)[i] %in% c('aux')) {
    study3_not$Head_POS[i] <- 'cop'
  }
}

study3_not_child <- subset(study3_not, Role %in% c('Target_Child'))
study3_not_parent <- subset(study3_not, Role %in% c('Parent'))

study3_not_child_function <- data.frame(table(study3_not_child$Negation_dep))
names(study3_not_child_function) <- c('Dependency', 'Frequency')
study3_not_child_function$Dependency <- reorder(study3_not_child_function$Dependency, -study3_not_child_function$Frequency)
study3_not_child_function$Proportion <- study3_not_child_function$Frequency * 100 / sum(study3_not_child_function$Frequency)
study3_not_child_function$Role <- as.vector(rep('Target_Child', nrow(study3_not_child_function)))

study3_not_parent_function <- data.frame(table(study3_not_parent$Negation_dep))
names(study3_not_parent_function) <- c('Dependency', 'Frequency')
study3_not_parent_function$Dependency <- reorder(study3_not_parent_function$Dependency, -study3_not_parent_function$Frequency)
study3_not_parent_function$Proportion <- study3_not_parent_function$Frequency * 100 / sum(study3_not_parent_function$Frequency)
study3_not_parent_function$Role <- as.vector(rep('Parent', nrow(study3_not_parent_function)))

study3_not_function <- rbind(study3_not_child_function, study3_not_parent_function)

```

```{r notFunction, fig.cap="Comparing the syntactic function of not between children and parent.", fig.env="figure", fig.height=6}
ggplot(study3_not_function, aes(x=Dependency, y=Proportion, fill=Role))+ 
  geom_bar(position=position_dodge(),stat='identity')+
  scale_fill_manual(values=c("#0072B2", "#CC79A7"))+
  labs(x="Syntactic function (dependency relation)")+
  labs(y="Proportion (%)")+
  scale_y_continuous(limits=c(0,100))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top")

```

Therefore we turned to examine the POS distributions of the syntactic heads when their syntactic dependency with *not* is *NEG*. As revealed in Figure \@ref{fig:notPOS}, the most common syntactic categories that *not* modify in both child and parent production are:
(1) *cop* (e.g. *cause I'm not*; *it's not on here*)
(2) *pro* (e.g. *I not got nothing*; *not that*)
(3) *n* (e.g. *not my Beecer*; *not fork*)
(4) *adv* (e.g. *not again*; *not really*)
(5) *v* (e.g. *not find it*; *go not*)

```{r load data}

study3_not_child_pos <- data.frame(table(subset(study3_not_child, Negation_dep %in% c('NEG'))$Head_POS))
names(study3_not_child_pos) <- c('POS', 'Frequency')
study3_not_child_pos$POS <- reorder(study3_not_child_pos$POS, -study3_not_child_pos$Frequency)
study3_not_child_pos$Proportion <- study3_not_child_pos$Frequency * 100 / sum(study3_not_child_pos$Frequency)
study3_not_child_pos$Role <- as.vector(rep('Target_Child', nrow(study3_not_child_pos)))

study3_not_parent_pos <- data.frame(table(subset(study3_not_parent, Negation_dep %in% c('NEG'))$Head_POS))
names(study3_not_parent_pos) <- c('POS', 'Frequency')
study3_not_parent_pos$POS <- reorder(study3_not_parent_pos$POS, -study3_not_parent_pos$Frequency)
study3_not_parent_pos$Proportion <- study3_not_parent_pos$Frequency * 100 / sum(study3_not_parent_pos$Frequency)
study3_not_parent_pos$Role <- as.vector(rep('Parent', nrow(study3_not_parent_pos)))

study3_not_pos <- rbind(study3_not_child_pos, study3_not_parent_pos)

```

```{r notPOS, fig.cap="Comparing the syntactic categories of the syntactic heads of not between children and parent.", fig.env="figure", fig.height=6}
ggplot(study3_not_pos, aes(x=POS, y=Proportion, fill=Role))+ 
  geom_bar(position=position_dodge(),stat='identity')+
  scale_fill_manual(values=c("#0072B2", "#CC79A7"))+
  labs(x="Syntactic categories (POS))")+
  labs(y="Proportion (%)")+
  scale_y_continuous(limits=c(0,100))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top")

```

To compare the trajectory of *not* between child and parent production, we focused on the above top five most frequent syntactic categories that *not* modifies. Since these syntactic categories are fundamental different, we examined them individually. Comparing across the figures below, there does not seem to be a big developmental differences between the usage of *not* when modifying different syntactic categories. Children start producing *not* as a modifier around 20 - 24 months and seem to reach adult-level production around the age of 28 - 30 months.

```{r load data}
not_child_cop <- subset(study3_not_child, Head_POS %in% c('cop'))
not_child_cop_age <- aggregate(data.frame(not_child_cop$Head_POS), by=list(not_child_cop$Age),FUN=length)
names(not_child_cop_age) <- c('Age', 'Frequency')
not_child_cop_age$Proportion <- not_child_cop_age$Frequency * 100 / sum(not_child_cop_age$Frequency)
not_child_cop_age$Role <- as.vector(rep('Target_Child', nrow(not_child_cop_age)))

not_parent_cop <- subset(study3_not_parent, Head_POS %in% c('cop'))
not_parent_cop_age <- aggregate(data.frame(not_parent_cop$Head_POS), by=list(not_parent_cop$Age),FUN=length)
names(not_parent_cop_age) <- c('Age', 'Frequency')
not_parent_cop_age$Proportion <- not_parent_cop_age$Frequency * 100 / sum(not_parent_cop_age$Frequency)
not_parent_cop_age$Role <- as.vector(rep('Parent', nrow(not_parent_cop_age)))

not_cop_age <- rbind(not_child_cop_age, not_parent_cop_age)

```


```{r notCOP, fig.cap="Comparing the trajectory of not modifying copula verb "be", between children and parent.", fig.env="figure", fig.height=6}
ggplot(not_cop_age, aes(x=Age, y=Proportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top") +
  ggtitle("cop + not")

```

```{r load data}
not_child_pro <- subset(study3_not_child, Head_POS %in% c('pro'))
not_child_pro_age <- aggregate(data.frame(not_child_pro$Head_POS), by=list(not_child_pro$Age),FUN=length)
names(not_child_pro_age) <- c('Age', 'Frequency')
not_child_pro_age$Proportion <- not_child_pro_age$Frequency * 100 / sum(not_child_pro_age$Frequency)
not_child_pro_age$Role <- as.vector(rep('Target_Child', nrow(not_child_pro_age)))

not_parent_pro <- subset(study3_not_parent, Head_POS %in% c('pro'))
not_parent_pro_age <- aggregate(data.frame(not_parent_pro$Head_POS), by=list(not_parent_pro$Age),FUN=length)
names(not_parent_pro_age) <- c('Age', 'Frequency')
not_parent_pro_age$Proportion <- not_parent_pro_age$Frequency * 100 / sum(not_parent_pro_age$Frequency)
not_parent_pro_age$Role <- as.vector(rep('Parent', nrow(not_parent_pro_age)))

not_pro_age <- rbind(not_child_pro_age, not_parent_pro_age)

```


```{r notPro, fig.cap="Comparing the trajectory of not modifying pronouns, between children and parent.", fig.env="figure", fig.height=6}
ggplot(not_pro_age, aes(x=Age, y=Proportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top") +
  ggtitle("pro + not")

```

```{r load data}
not_child_n <- subset(study3_not_child, Head_POS %in% c('n'))
not_child_n_age <- aggregate(data.frame(not_child_n$Head_POS), by=list(not_child_n$Age),FUN=length)
names(not_child_n_age) <- c('Age', 'Frequency')
not_child_n_age$nportion <- not_child_n_age$Frequency * 100 / sum(not_child_n_age$Frequency)
not_child_n_age$Role <- as.vector(rep('Target_Child', nrow(not_child_n_age)))

not_parent_n <- subset(study3_not_parent, Head_POS %in% c('n'))
not_parent_n_age <- aggregate(data.frame(not_parent_n$Head_POS), by=list(not_parent_n$Age),FUN=length)
names(not_parent_n_age) <- c('Age', 'Frequency')
not_parent_n_age$nportion <- not_parent_n_age$Frequency * 100 / sum(not_parent_n_age$Frequency)
not_parent_n_age$Role <- as.vector(rep('Parent', nrow(not_parent_n_age)))

not_n_age <- rbind(not_child_n_age, not_parent_n_age)

```


```{r notN, fig.cap="Comparing the trajectory of not modifying nouns, between children and parent.", fig.env="figure", fig.height=6}
ggplot(not_n_age, aes(x=Age, y=nportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top") +
  ggtitle("n + not")

```

```{r load data}
not_child_adv <- subset(study3_not_child, Head_POS %in% c('adv'))
not_child_adv_age <- aggregate(data.frame(not_child_adv$Head_POS), by=list(not_child_adv$Age),FUN=length)
names(not_child_adv_age) <- c('Age', 'Frequency')
not_child_adv_age$nportion <- not_child_adv_age$Frequency * 100 / sum(not_child_adv_age$Frequency)
not_child_adv_age$Role <- as.vector(rep('Target_Child', nrow(not_child_adv_age)))

not_parent_adv <- subset(study3_not_parent, Head_POS %in% c('adv'))
not_parent_adv_age <- aggregate(data.frame(not_parent_adv$Head_POS), by=list(not_parent_adv$Age),FUN=length)
names(not_parent_adv_age) <- c('Age', 'Frequency')
not_parent_adv_age$nportion <- not_parent_adv_age$Frequency * 100 / sum(not_parent_adv_age$Frequency)
not_parent_adv_age$Role <- as.vector(rep('Parent', nrow(not_parent_adv_age)))

not_adv_age <- rbind(not_child_adv_age, not_parent_adv_age)

```


```{r notADV, fig.cap="Comparing the trajectory of not modifying adverbss, between children and parent.", fig.env="figure", fig.height=6}
ggplot(not_adv_age, aes(x=Age, y=nportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top") +
  ggtitle("adv + not")

```

```{r load data}
not_child_v <- subset(study3_not_child, Head_POS %in% c('v'))
not_child_v_age <- aggregate(data.frame(not_child_v$Head_POS), by=list(not_child_v$Age),FUN=length)
names(not_child_v_age) <- c('Age', 'Frequency')
not_child_v_age$nportion <- not_child_v_age$Frequency * 100 / sum(not_child_v_age$Frequency)
not_child_v_age$Role <- as.vector(rep('Target_Child', nrow(not_child_v_age)))

not_parent_v <- subset(study3_not_parent, Head_POS %in% c('v'))
not_parent_v_age <- aggregate(data.frame(not_parent_v$Head_POS), by=list(not_parent_v$Age),FUN=length)
names(not_parent_v_age) <- c('Age', 'Frequency')
not_parent_v_age$nportion <- not_parent_v_age$Frequency * 100 / sum(not_parent_v_age$Frequency)
not_parent_v_age$Role <- as.vector(rep('Parent', nrow(not_parent_v_age)))

not_v_age <- rbind(not_child_v_age, not_parent_v_age)

```


```{r notv, fig.cap="Comparing the trajectory of not modifying verbs, between children and parent.", fig.env="figure", fig.height=6}
ggplot(not_v_age, aes(x=Age, y=nportion, fill=Role))+ 
  geom_bar(position="dodge",stat='identity')+
  scale_fill_manual(values=c("#9999CC", "#66CC99"))+
#  geom_col(width = 0.5)+
  labs(x="Age")+
  labs(y="Proportion (%)")+
  scale_x_continuous(breaks=seq(0, 72, 6))+
  scale_y_continuous(limits=c(0,15))+
  theme(axis.title.x = element_text(size=20), 
        axis.text.x = element_text(size = 15, angle = 45),
        axis.title.y = element_text(size=20),
        axis.text.y = element_text(size = 15, angle = 45),
        legend.title=element_text(size=15),
        legend.text=element_text(size=15))+ 
  theme(legend.position="top") +
  ggtitle("v + not")

```
Make it more refined;

# General Discussion

\newpage

# Acknowledgments

# Declaration of Interest Statement

# References
```{r create_r-references}
r_refs(file = "r-references.bib")
```
refs/remotes/origin/master

# Appendices

The auxiliary category in our previous figures lump together a wide variety of auxiliary verbs that develop at different rates. Figure \@ref(fig:AuxWords) shows the production of common negative auxiliary verbs in the speech of children and parents, sorted from top-left to bottom-right based on frequency. The most frequent negative auxiliary form in child-directed speech is *don't* and it is also the earliest and most frequent auxiliary form in children's speech. Children start producing it between 12-24 months and they quickly reach the parents' rate at 36 months. Perhaps the fastest development occurs with the auxiliary *can't*. Children start producing it between 18-24 months and very quickly surpass their parents' rate. 

```{r AuxWords, fig.env="figure", fig.height=7, fig.width=7, fig.pos = "!H", fig.cap="Relative frequency of negated auxiliary verbs in the speech of parents (green triangles) and children (red circles). The dashed line marks 24 months on the x axis."}
word_table <- readRDS(file="processed_data/word_table")

aux_plot <-
  word_table %>%
  filter(category=="auxiliary", polarity=="negative", word!="aint", word!="other", word!="amnt", word!="maynt", word!="mightnt", word!="shant")
  
aux_plot$word <- fct_relevel(aux_plot$word, "dont", "cant", "didnt", "isnt", "doesnt", "wont", "arent", "wasnt", "havent", "hasnt", "couldnt", "wouldnt", "werent", "shouldnt", "hadnt", "mustnt")

  ggplot(aux_plot, aes(age, ppt, fill=speaker, color=speaker, shape=speaker)) +
  geom_point(stat="identity", aes(fill=speaker, color=speaker, shape=speaker)) +
  geom_line() +
  facet_wrap(.~word, scales = "free_y") +
  scale_x_continuous(breaks=seq(0, 72, by = 6)) +
  geom_vline(xintercept = 24, linetype = "dashed") +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times"), legend.position = "none")
```

Figure \@ref(fig:pronouns) shows the development of negative and positive indefinite pronouns: *everything*, *nothing*, *something*. Children start producing these words quite early as well, with *nothing* reaching the parent level of production at 30 months. 

```{r pronouns, fig.env="figure", fig.height=7.5, fig.height=2.5, fig.cap="Relative frequency of pronouns *everything*, *something*, and *nothing*"}
word_table %>%
  filter(word=="something" | word=="nothing" | word=="everything") %>%
  ggplot(aes(age, ppt, color=speaker, shape=speaker)) +
  geom_point(stat="identity", aes(color=speaker, shape=speaker)) +
  geom_line() +
  facet_wrap(.~word, scale="free_y") +
  scale_x_continuous(breaks=seq(0, 72, by = 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times"))
```

```{r quantifiers, fig.env="figure", fig.height=2.5, fig.width=5, fig.cap="Relative frequency of quantifeirs *none*, *some*, and *all*."}
word_table %>%
  filter(word=="some" | word=="none" | word=="all") %>%
  ggplot(aes(age, ppt, color=speaker, shape=speaker)) +
  geom_point(stat="identity", aes(color=speaker, shape=speaker)) +
  geom_line() +
  facet_wrap(.~word, scale="free_y") +
  scale_x_continuous(breaks=seq(0, 72, by = 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times"))
```

Adverbs of frequency

```{r adverbs, fig.env="figure", fig.height=2.5, fig.width=7.5, fig.cap="Relative frequency for adverbs of frequency *always*, *never*, and *sometimes* in the speech of parents and children."}
word_table %>%
  filter(word=="never" | word=="sometimes" | word=="always") %>%
  ggplot(aes(age, ppt, color=speaker, shape=speaker)) +
  geom_point(stat="identity", aes(color=speaker, shape=speaker)) +
  geom_line() +
  facet_wrap(.~word, scale="free_y") +
  scale_x_continuous(breaks=seq(0, 72, by = 6)) +
  theme_classic() +
  theme(text = element_text(size=10, family="Times"))
```


\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

\endgroup
