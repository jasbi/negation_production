---
title: "Combinatorial Capacity of English Negation in Early Child Language"
bibliography: library.bib
csl: apa6.csl
document-params: "10pt, letterpaper"

author-information: > 
    \author{{\large \bf Morton Ann Gernsbacher (MAG@Macc.Wisc.Edu)} \\ Department of Psychology, 1202 W. Johnson Street \\ Madison, WI 53706 USA
    \AND {\large \bf Masoud Jasbi (jasbi@ucdavis.edu)} \\ Department of Linguistics, 469 Kerr Hall, One Shields Avenue \\ Davis, CA 95 USA}

abstract: >
    Negation is very important for langauge and thought. How does it develop in the language of children? There has been many guessses like rejection, non-existence, denail, etc. but it has been hard to assess because these concepts are vaguge. Here we assess the combinatorial capacity of early negation in children's productions, and use words negation combines with as a proxy for early concepts expressed by it. We show some important stuff.
    
keywords: >
    negation; combinatorial capacity; corpus anlysis.
    
output: cogsci2016::cogsci_paper
#final-submission: \cogscifinalcopy
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=3, fig.height=3, fig.crop = F, 
                      fig.pos = "tb", fig.path='figs/',
                      echo=F, warning=F, cache=F, 
                      message=F, sanitize = T)
```

```{r, libraries}
library(png)
library(grid)
library(ggplot2)
library(xtable)
library('RColorBrewer')
library(gridExtra)
library(tidyverse)
```

# Introduction

Negation is an abstract concept, lexicalized in all previously studied human languages, and crucial to everyday communication. It can help a coffee shop divide its menu into "coffee" and "not coffee" sections, with the "not coffee" section bringing together diverse items that otherwise cannot be labeled. It can help us regulate each others' actions in a sign like "no mask, no entry".  It can also communicate our deepest wants and dislikes when we say . But how does this crucial abstract concept emerge in human mind? Does language play a role in its emergence or does language simply adopt it for communication? 

There has been several influential hypotheses on the conceptual origins of negation and the functions it plays in early communication. Starting a century and a half ago, @darwin1872expression thought that negation has roots in the expression of human emotions and desires. He hypothesized that the earliest manifestation of negation and affirmation in infants is when they refuse food from parents, by withdrawing their heads laterally, or when they accept the food, by inclining their heads forward. He suggested that head shaking and nodding as common gestures for negation and affirmation have developed from this early habit. Similarly, many researchers studying early functions of negative morphemes like *no* proposed that children use them to "reject" or "refuse" [@bloom1970language; @pea1978; @choi1988semantic]. For example, when they are asked "do you want juice?", they may say "no", "not want it", or "don't like it". @pea1978 proposed that this function of negation is the first to emerge in children's early language and communication.

@bloom1970language suggested that the use of negation to expresses "non-existence" emerges before rejection or refusal in children's early speech. For example, when an object that children expect to be present is not present, children may say: "no window", "no fish in the bathroom", "Kathrine have no socks on" and "I do not have underpants". Two close concepts to non-existence discussed in the literature are "disappearance" and "non-occurrence" [@de1979form]. Disappearance refers to situations where an object disappears and children use negation to express it such as " " and "no more noise". Non-occurence refers to cases when an expected action or event does not occur as in "not working" or "doggie not barking". Some researchers referred to these cases as "failures" and included examples like "no fit in da box" or "it don't fit" [@choi1988semantic; @cameron2007part]. Non-existence can also be expressed by negation of locative prepositional phrases (e.g. "no in there" or "daddy was not on the phone"). While rejection was hypothesized to interact with human emotions and desires, non-existence (broadly construed to include "disappearance" and "non-occurrence") likely interacts with human perception. @choi1988semantic proposed that children's early linguistic negation is used to express both rejection and non-existence.

@choi1988semantic introduced "prohibition" as a function of early negation and suggested that it emerges as early as rejection and non-existence. In cases of prohibition, children use linguistic negation to stop others from performing some action. For example they may say: "don't go" or "do not spill milk". A special case of prohibition is "self-prohibition". For example, a child may approach prohibited food but immediately say "no, don't eat" to stop herself from doing the prohibited action. @choi1988semantic also discussed instances of negation in which children communicate their own "inability" to perform an action, for example "I can't reach" or "I cannot zip it". She suggested that these instances emerge after the first phase (i.e. non-existence, rejection, prohibition). Instances of prohibition and inability are similar in that both involve conceptualizing actions and may interacting with early development of motor control. 

A fourth function of negation discussed in the literature is "denial". @bloom1970language originally defined it as asserting that "an actual or supposed predication was not the case". For example a child may say: "It's not sharp". Later researchers labeled it as "truth-functional negation" and suggested that it is used to negate the truth of a proposition [@cameron2007part]. Of course this definition can be problematic given that it depends on the assumed logical system and its definition of proposition and truth. One sub-function of traditional "denials" we focus on in this study is "labeling". This is often realized as the negation of nominal or adjectival predicates such as "this is not a bunny", "not red", or "this isn't a reptile". 

A fifth function discussed by @choi1988semantic is "epistemic negation". There has been no proposal for negation originating in children's understanding of their own or others' mental states. In fact, most development theory of mind accounts assume that this ability emerges later in children. However, pervious studies have reported many instances of negation modify mental state verbs such as *know*, *think*, and *remember* (e.g. "I not know").

Previous research has varied on the number of communicative functions proposed for early linguistic negation as well as the order of emergence in children's speech. Table ? summarizes previous proposals. There have been two issues to deal with in this area. First, there seems to be great deal of variability among children. For example, Nordmeyer and Frank looked at five children in Providence and found .... . Second, previous research has had to rely on human annotation and classification of negative utterances which is often difficult and very time-consuming. In this paper, we address the second issue by looking at negative constructions in early child langauge. We start with the widely accepted assumption that negation is a higher order operator or function, operating on lower level concepts. The question we ask is: what type of concepts does linguistic negation operate on in early child language? Do we find negation starting in a limited conceptual domain and then expanding to others? Or do we find it operating across different domains as early as we can attest it?

|Study|Proposed developmental order for the functions of negation|
|---------------|----------------|
|Bloom|Nonexistence > Rejection > Denial|
|McNiel|Nonexistence > Non-entailing Denial > Rejection > Entailing Denial|
|Choi|*there's no water*, *no more candy*|
|Cameron Faulkner|*that's not a cat*, *this is not red*|
|Nordmeyer and Frank|*I don't know/remember/think-so*|

Previous research also considered gestures or single-word uses of "no" and what they communicated in the utterance context []. Here we focus on the "combinatorial capacity" of early negation. We look at multi-word negative utterances and see what children compose negation with in early childhood. For example, do children use negation with a modal like *can* or a mental state verb like *know*? How frequently?

|Function|Linguistic Composition|Examples|
|------|--------|--------------------|--------------------|
|Rejection| With *like* or *want* | "I not like it", "not want it" |
|Epistemic | know, think, remember  | "I not know" |
|Prohibition | with imperative subjectless *do* | "do not spill milk"|
|Inability | with modal *can* | "I cannot zip it"|
|Labeling | modifying nominal or adjectival predicatives | "that's not a crocodile"; "it's no interesting"|
|Non-existence | expletives; with a nominal; *no more* | "there is no soup"; "no juice"; "no more milk" | 
|Possession | have; with possesive pronouns| "not have the toy"; "not mine" | 
  
# Experiments

## Data and preprocessing 

For developmental data of child language in English, we turned to the CHILDES database [@macwhinney2000childes], which provides child-parent conversational interactions.\footnote{Code and data are in quarantine at https://somewhereonearth.}. We focused on speech produced by children with typical development within the age range of 12 - 72 months. As this study focuses on negation constructions at the utterance-level, we extracted individual utterances with any of the three negation markers to be investigated in this study: *no*, *not* and *n't*. Utterances with only one lexical token (e.g. *no !*) were not considered as here we aim to address particularly the question of what negation markers could *combine* with. In addition, cases where the negation markers only serve as a discourse marker (e.g. *no I like this one* /*no no no Mommy*) were excluded as well. Preprocessing led to a data set of 365,260 utterances with negation structures from a total of 811 children across 56 corpora.

Figure \@ref(fig:speaker_stats)

```{r speakerdata, include=FALSE}
stats <-read.csv('data/age_info.txt', header = T, sep = '\t')
stats$Role[which(stats$Role == "Father")] <- 'Parent'
stats$Role[which(stats$Role == "Mother")] <- 'Parent'
stats$Role[which(stats$Role == "Target_Child")] <- 'Child'

child_stats <- data.frame(table(subset(stats, Role %in% c('Child'))$Age))
names(child_stats) <- c('Age', 'Freq')
child_stats$Ratio <- child_stats$Freq / sum(child_stats$Freq)
child_stats$Role <- rep('Child', nrow(child_stats))

parent_stats <- data.frame(table(subset(stats, Role %in% c('Parent'))$Age))
names(parent_stats) <- c('Age', 'Freq')
parent_stats$Ratio <- parent_stats$Freq / sum(parent_stats$Freq)
parent_stats$Role <- rep('Parent', nrow(parent_stats))

stats_data <- rbind(child_stats, parent_stats)
```

```{r speaker_stats, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=3.5, fig.height=2.5, fig.cap = "Distribution of the number of utterances with negative morphemes in child and parent speech." }
stats_data %>% 
  ggplot(aes(x = as.numeric(Age) + 12, y = round(Ratio, 2), group = Role, color = Role)) +
  geom_point(aes(color = Role, shape = Role)) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("forestgreen", "black")) + 
  geom_line(aes(color = Role, linetype = Role)) + 
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("ratio")
```

## Negation functions

In this section, we describe in details our automatic extraction of syntactic structures that have distinct negation functions and express different types of negative concepts. The current English data from CHILDES contains morphosyntactic information [@sagae2010morphosyntactic] such as part-of-speech (POS) information as well as grammatical or syntactic dependency relations.\footnote{Besides using the provided POS and syntactic dependency information in CHILDES, we also experimented with the state-of-the-art parser from Stanza [@qi-etal-2020-stanza], an open-source natural language processing library. There were no worth noting differences in the analyses for the negation constructions.} We take advantage of information as such when identifying our constructions of interest. Since most of the available annotations were obtained via the existing tools in CHILDES, in order to further alleviate potential errors induced from the automatic process, an utterance with a negative morpheme(s) was only considered when the negative morpheme has either a POS of *neg* or *qn*, the latter of which was mainly for cases with *no* as a quantifier. Furthermore, the syntactic functions and relations of the negative morphemes should not be enumeration (*no no no*), communicators or discourse markers.

After extracting all instances with negative morphemes, the developmental trajectory of each construction type as described in the previous section was analyzed. While the matter of interest here is child speech, we also compared patterns in child production to those in parent speech as references at the corresponding age of the child. Then we combined the development of all construction types for analysis as a whole.

```{r function}
entropy <- function(data){
  start = 0
  for (i in 1:nrow(data)){
    p = as.vector(data$Ratio)[i] / 100
#    print(p)
    start = start - p * log2(p)
  }
  
  return(start)
}
```

### Rejection

Under the broader context of expressing emotion [@darwin1872expression], we focused particularly on utterances that function as rejections. Specifically, we examined cases where the lemma form of the head verb of the phrase is either *like* or *want*, and the head verb is modified by one of the three negative morphemes. Each of the utterances either takes a subject or has no subject at all. And the existence of a subject was determined via searching for a word in the utterance that has the *SUBJ* dependency relation with the head verb.


```{r emotiondata, include=FALSE}
emotion <-read.csv('data/neg_emotion.txt', header = T, sep = '\t')
# emotion <- subset(emotion, Subj == 'I' | Subj == 'NONE')
emotion$Role[which(emotion$Role == "Father")] <- 'Parent'
emotion$Role[which(emotion$Role == "Mother")] <- 'Parent'
emotion$Role[which(emotion$Role == "Target_Child")] <- 'Child'

child_emotion <- subset(emotion, Role %in% c('Child'))
parent_emotion <- subset(emotion, Role %in% c('Parent'))

child_like <- subset(child_emotion, Head %in% c('like'))
child_want <- subset(child_emotion, Head %in% c('want'))
parent_like <- subset(parent_emotion, Head %in% c('like'))
parent_want <- subset(parent_emotion, Head %in% c('want'))

child_like <- data.frame(table(child_like$Age))
child_like$Role <- rep('Child', nrow(child_like))
child_like$Head <- rep('like', nrow(child_like))
child_like$Ratio <- child_like$Freq / sum(child_like$Freq)

child_want <- data.frame(table(child_want$Age))
child_want$Role <- rep('Child', nrow(child_want))
child_want$Head <- rep('want', nrow(child_want))
child_want$Ratio <- child_want$Freq / sum(child_want$Freq)

parent_like <- data.frame(table(parent_like$Age))
parent_like$Role <- rep('Parent', nrow(parent_like))
parent_like$Head <- rep('like', nrow(parent_like))
parent_like$Ratio <- parent_like$Freq / sum(parent_like$Freq)

parent_want <- data.frame(table(parent_want$Age))
parent_want$Role <- rep('Parent', nrow(parent_want))
parent_want$Head <- rep('want', nrow(parent_want))
parent_want$Ratio <- parent_want$Freq / sum(parent_want$Freq)

emotion_data <- rbind(child_like, child_want, parent_like, parent_want)
names(emotion_data) <- c('Age', 'Freq', 'Role', 'Head', 'Ratio')
```

Additionally, other than expressions that the speaker used to describe their own emotion (e.g. (1)) or their (in)ability to do so (e.g. (2)), we also included cases that express rhetorical inquiries of emotions from one interlocutor addressed to another (e.g. (3)) as well as instances where the speaker is describing the emotion of somebody else (e.g. (4)).
Overall our data extraction resulted in a total of `r format(nrow(emotion), big.mark=",")` utterances (Child: `r format(nrow(child_emotion), big.mark=",")`; Parent: `r format(nrow(parent_emotion), big.mark=",")`).

&nbsp;
(1) *I no like sea* / *don't wanna go*

&nbsp;
(2) *I can't like that*

&nbsp;
(3) *don't you wanna try it*

&nbsp;
(4) *Sarah doesn't like that either*

To compare the patterns between child and parent speech, for the function of rejection, as well as for all other functions that negation serve (see below), we measured the following four metrics as indexes of developmental characteristics if applicable. These metrics were applied to child and parent utterances respectively. The first one is the relative ratio of each of the three negative morphemes overall. For instance, given the `r format(nrow(child_emotion), big.mark=",")` from child speech that serve as rejections, there are 8,531 cases with the negative morpheme *no*; then the ratio of these utterances was calculated as 8,531 / `r format(nrow(child_emotion), big.mark=",")` = 0.41. 

The second one is the relative ratio of negative morphemes within different head verbs (e.g. *like* vs. *want* for rejection). For example, again with child speech that express rejections, utterances where the negative morphemes modify the head verb *like* occur for 3,268 times; then the ratio of these cases was computed as 3,268 / `r format(nrow(child_emotion), big.mark=",")` = 0.16. 

The third one is the relative ratio of the negative utterances at different ages of the child. For instance, for rejection, at the age of 36 months, the total number of instances with the negative morphemes in child speech is 888; then their ratio was calculated as 888 / `r format(nrow(child_emotion), big.mark=",")` = 0.04.

The last one is the amount of variability in the production of the specific function across the age span of the child, which was measured with entropy [@cover_elements_1991] For example, after computing the relative ratio (*P(x_i)*) of the negative utterances at a number of $N$ ages of the child for the specific function, the production variability is calculated as the equation below.

$$
H(X) = -\sum_{i=1}^N P(x_i)log_2P(x_i)               
$$
In both child and parent speech, when articulating emotion with either of the two head verbs *like* and *want*, the most frequently used negative morpheme is *n't* combined with an auxiliary verb. Comparing the two different head verbs, overall the negative morphemes co-occur with *want* more frequently. With that being said, the amount of variability in both child and parent production is similar, a pattern that holds for both head verbs (Child *like*: 0.12; Child *want* 0.12; Parent *like*: 0.12; Parent *want*: 0.12).

On the other hand, when looking at the developmental trajectory, as presented in Figure \@ref{fig:emotion}, children's usage of negative morphemes is comparable regardless of the particular head verb. In general, children start applying the negative morphemes for the function of rejection more regularly around the age of 22 months. Within the context of the corpus data that we analyzed, their usage of these morphemes is the most frequent during the age range of 25 - 36 months, then gradually decreases as they age.

```{r emotion, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=3.5, fig.height=3.5, set.cap.width=T, num.cols.cap=1, fig.cap = "Rejection" }

emotion_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(Ratio, 2), group = Role, color = Role)) +
  geom_point(aes(color = Role, shape = Role)) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("steelblue", "peru")) + 
  geom_line(aes(color = Role, linetype = Role)) + 
#  facet_grid(. ~ Role) +
  facet_grid(vars(Head)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("ratio")

```

### Epistemic state

```{r epistemicdata, include=FALSE}

epistemic <-read.csv('data/neg_epistemic.txt', header = T, sep = '\t')
epistemic$Role[which(epistemic$Role == "Father")] <- 'Parent'
epistemic$Role[which(epistemic$Role == "Mother")] <- 'Parent'
epistemic$Role[which(epistemic$Role == "Target_Child")] <- 'Child'

child_epistemic <- subset(epistemic, Role %in% c('Child'))
child_epistemic_know <- subset(child_epistemic, Head == 'know')
child_epistemic_remember <- subset(child_epistemic, Head == 'remember')
child_epistemic_think <- subset(child_epistemic, Head == 'think')
 
parent_epistemic <- subset(epistemic, Role %in% c('Parent'))
parent_epistemic_know <- subset(parent_epistemic, Head == 'know')
parent_epistemic_remember <- subset(parent_epistemic, Head == 'remember')
parent_epistemic_think <- subset(parent_epistemic, Head == 'think')

child_epistemic_know <- data.frame(table(child_epistemic_know$Age))
child_epistemic_know$Role <- rep('Child', nrow(child_epistemic_know))
child_epistemic_know$Head <- rep('know', nrow(child_epistemic_know))
child_epistemic_know$Ratio <- child_epistemic_know$Freq / sum(child_epistemic_know$Freq)

child_epistemic_remember <- data.frame(table(child_epistemic_remember$Age))
child_epistemic_remember$Role <- rep('Child', nrow(child_epistemic_remember))
child_epistemic_remember$Head <- rep('remember', nrow(child_epistemic_remember))
child_epistemic_remember$Ratio <- child_epistemic_remember$Freq / sum(child_epistemic_remember$Freq)

child_epistemic_think <- data.frame(table(child_epistemic_think$Age))
child_epistemic_think$Role <- rep('Child', nrow(child_epistemic_think))
child_epistemic_think$Head <- rep('think', nrow(child_epistemic_think))
child_epistemic_think$Ratio <- child_epistemic_think$Freq / sum(child_epistemic_think$Freq)

parent_epistemic_know <- data.frame(table(parent_epistemic_know$Age))
parent_epistemic_know$Role <- rep('Parent', nrow(parent_epistemic_know))
parent_epistemic_know$Head <- rep('know', nrow(parent_epistemic_know))
parent_epistemic_know$Ratio <- parent_epistemic_know$Freq / sum(parent_epistemic_know$Freq)

parent_epistemic_remember <- data.frame(table(parent_epistemic_remember$Age))
parent_epistemic_remember$Role <- rep('Parent', nrow(parent_epistemic_remember))
parent_epistemic_remember$Head <- rep('remember', nrow(parent_epistemic_remember))
parent_epistemic_remember$Ratio <- parent_epistemic_remember$Freq / sum(parent_epistemic_remember$Freq)

parent_epistemic_think <- data.frame(table(parent_epistemic_think$Age))
parent_epistemic_think$Role <- rep('Parent', nrow(parent_epistemic_think))
parent_epistemic_think$Head <- rep('think', nrow(parent_epistemic_think))
parent_epistemic_think$Ratio <- parent_epistemic_think$Freq / sum(parent_epistemic_think$Freq)

epistemic_data <- rbind(child_epistemic_think, child_epistemic_remember, child_epistemic_know, parent_epistemic_think, parent_epistemic_remember, parent_epistemic_know)
names(epistemic_data) <- c('Age', 'Freq', 'Role', 'Head', 'Ratio')

```

With regards to the broader domain of theory of mind, we attended to cases where the negative morphemes modify epistemic state. In particular, we focused on utterances that articulate the concept of unknowing (e.g. (5)) or uncertainty (e.g. (6)). The cases that were subject to analyses here included either *know*, *remember* or *think* as the head verb, modified by the negative morphemes or the combination of negation with auxiliaries. By these search criteria, instances where the speaker inquires about or describes the negative epistemic position of another speaker (e.g. (7)) were also selected. This led to a subset of `r format(nrow(epistemic), big.mark=",")` utterances in total (Child: `r format(nrow(child_epistemic), big.mark=",")`; Parent: `r format(nrow(parent_epistemic), big.mark=",")`).

&nbsp;
(5) *I not know* / *I didn't remember*

&nbsp;
(6) *I don't think so*

&nbsp;
(7) *don't you remember* / *She doesn't know this*


In both child and parent speech, the most frequently used negative morpheme that modifies epistemic state is *n't*, a pattern that is consistent across the three different head verbs. And the negative morphemes tend to co-occur more often in cases that describe the state of unknowing, which is indicated mainly by the verb *know*. Based on results from Figure \@ref{fig:epistemic}, the production of *know* for expressions of epistemic state starts earlier in comparison to *remember* and *think*. On the other hand, the production variability for each of the head verb (~0.12) is comparable to each other regardless of the particular speaker. Overall, children began to apply the negative morphemes to articulate this function in a more regular fashion around the age of 25 months.


```{r epistemic, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=3.5, fig.height=5, set.cap.width=T, num.cols.cap=1, fig.cap = "Epistemic" }

epistemic_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(Ratio, 2), group = Role, color = Role)) +
  geom_point(aes(color = Role, shape = Role)) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("steelblue", "peru")) + 
  geom_line(aes(color = Role, linetype = Role)) + 
  facet_grid(vars(Head)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("ratio")

```


### Prohibition

```{r motordata, include=FALSE}

motor <-read.csv('data/neg_motor.txt', header = T, sep = '\t')
motor <- subset(motor, Subj == 'I' | Subj == 'NONE')
motor$Role[which(motor$Role == "Father")] <- 'Parent'
motor$Role[which(motor$Role == "Mother")] <- 'Parent'
motor$Role[which(motor$Role == "Target_Child")] <- 'Child'

child_motor <- subset(motor, Role %in% c('Child'))
parent_motor <- subset(motor, Role %in% c('Parent'))

child_prohibition <- subset(child_motor, Function %in% c('prohibition') & Subj == 'NONE')
child_inability <- subset(child_motor, Function %in% c('inability') & Subj == 'I')
parent_prohibition <- subset(parent_motor, Function %in% c('prohibition') & Subj == 'NONE')
parent_inability <- subset(parent_motor, Function %in% c('inability') & Subj == 'I')

child_prohibition <- data.frame(table(child_prohibition$Age))
child_prohibition$Role <- rep('Child', nrow(child_prohibition))
child_prohibition$Function <- rep('prohibition', nrow(child_prohibition))
child_prohibition$Ratio <- child_prohibition$Freq / sum(child_prohibition$Freq)

child_inability <- data.frame(table(child_inability$Age))
child_inability$Role <- rep('Child', nrow(child_inability))
child_inability$Function <- rep('inability', nrow(child_inability))
child_inability$Ratio <- child_inability$Freq / sum(child_inability$Freq)

parent_prohibition <- data.frame(table(parent_prohibition$Age))
parent_prohibition$Role <- rep('Parent', nrow(parent_prohibition))
parent_prohibition$Function <- rep('prohibition', nrow(parent_prohibition))
parent_prohibition$Ratio <- parent_prohibition$Freq / sum(parent_prohibition$Freq)

parent_inability <- data.frame(table(parent_inability$Age))
parent_inability$Role <- rep('Parent', nrow(parent_inability))
parent_inability$Function <- rep('inability', nrow(parent_inability))
parent_inability$Ratio <- parent_inability$Freq / sum(parent_inability$Freq)

prohibition_data <- rbind(child_prohibition, parent_prohibition)
names(prohibition_data) <- c('Age', 'Freq', 'Role', 'Function', 'Ratio')

inability_data <- rbind(child_inability, parent_inability)
names(inability_data) <- c('Age', 'Freq', 'Role', 'Function', 'Ratio')

motor_data <- rbind(child_prohibition, child_inability, parent_prohibition, parent_inability)
names(motor_data) <- c('Age', 'Freq', 'Role', 'Function', 'Ratio')

```

For utterances that articulate the function of prohibition, we focused on cases where the negative morphemes are combined with the auxiliary verb *do* (*do*, *does*, *did*) and the auxiliary does not take any subject (e.g. (8)). In certain cases the negative morphemes and the auxiliary together modifies a head verb. For instances as such, in order to not overlap with the function of rejection, epistemic state, non-existence and possession (see below),  our search excluded cases where the head verb has any of the following lemma forms: *like*, *want*, *know*, *think*, *remember*, *have*. This resulted in a total of `r format(sum(prohibition_data$Freq), big.mark=",")` utterances (Child: `r format(sum(child_prohibition$Freq), big.mark=",")`; Parent: `r format(sum(parent_prohibition$Freq), big.mark=",")`).

After applying our metrics, overall the most frequently used negative morpheme is *n't* when articulating prohibition. The amount of production variability for this function is comparable in both child and parent speech, with an approximate value of 0.12. The developmental trajectory of using the negative morphemes to serve this function (Figure \@ref[fig:prohibition]) is comparable to that of the previous ones, where children started more regular usage of negative morphemes around the age of 23 months.

&nbsp;
(8) *don't blame Charlotte* / *don't*

```{r prohibition, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=3.5, fig.height=2, set.cap.width=T, num.cols.cap=1, fig.cap = "Prohibition" }

prohibition_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(Ratio, 2), group = Role, color = Role)) +
  geom_point(aes(color = Role, shape = Role)) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("steelblue", "peru")) + 
  geom_line(aes(color = Role, linetype = Role)) + 
#  facet_grid(vars(Function)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("ratio")

```

### Inability 

With regards to the function of inability, we analyzed instances where the negative morphemes co-occur with the auxiliary *can* (*can* and *could*; e.g. (9)). Again, for instances with a head verb modified by the negatiive morphemes and the auxiliary, we filtered out cases where the head verbs are the focus for other functions, the same way as our analyses for the function of prohibition analyzed above. Cases that do not have a subject (*can't play*) or do not contain a subject other than I (*you can't do that*) could yield ambiguous readings without taking a larger discourse context into account; they could be a rhetorical question or also express the concept of prohibition. Therefore to avoid potential ambiguity, we excluded instances as such. In other words, when searching for utterances that articulate inability, we restricted our analyses only to cases with a subject *I*. This led to a subset of `r format(sum(inability_data$Freq), big.mark=",")` utterances (Child: `r format(sum(child_inability$Freq), big.mark=",")`; Parent: `r format(sum(parent_inability$Freq), big.mark=",")`).

&nbsp;
(9) *I can't see* / *I can't*

Comparing child and parent production, the negative morpheme that is used most frequently is also *n't*. As shown in Figure \@ref{fig:inaibility} The developmental trajectory of this function is similar to that for prohibition, and the negative morphemes are applied more regularly starting around the age of 23 months. The amount of production variability in both child and parent speech is approximately 0.12.

```{r inability, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=3.5, fig.height=2, set.cap.width=T, num.cols.cap=1, fig.cap = "Inability" }

inability_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(Ratio, 2), group = Role, color = Role)) +
  geom_point(aes(color = Role, shape = Role)) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("steelblue", "peru")) + 
  geom_line(aes(color = Role, linetype = Role)) + 
#  facet_grid(vars(Function)) +
  scale_x_continuous(breaks=seq(12, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("ratio")

```

### Language learning via labeling


```{r learningdata, include=FALSE}

learning <-read.csv('data/neg_learning.txt', header = T, sep = '\t')
learning$Role[which(learning$Role == "Father")] <- 'Parent'
learning$Role[which(learning$Role == "Mother")] <- 'Parent'
learning$Role[which(learning$Role == "Target_Child")] <- 'Child'

child_learning <- subset(learning, Role %in% c('Child'))
parent_learning <- subset(learning, Role %in% c('Parent'))

child_learning <- data.frame(table(child_learning$Age))
child_learning$Role <- rep('Child', nrow(child_learning))
child_learning$Function <- rep('labeling', nrow(child_learning))
child_learning$Ratio <- child_learning$Freq / sum(child_learning$Freq)

parent_learning <- data.frame(table(parent_learning$Age))
parent_learning$Role <- rep('Parent', nrow(parent_learning))
parent_learning$Function <- rep('labeling', nrow(parent_learning))
parent_learning$Ratio <- parent_learning$Freq / sum(parent_learning$Freq)

learning_data <- rbind(child_learning,  parent_learning)
names(learning_data) <- c('Age', 'Freq', 'Role', 'Function', 'Ratio')

```


For the function of language learning, particularly labeling, we concentrated on cases where negative morphemes are adopted to indicate the identity (e.g. (10)), and/or characteristics (e.g. (11)) of a predicative nominal. In addition, we also included instances where the negative morphemes are used to modify a predicative adjective (e.g. (12)). Following these criteria, utterances where the negative morpheme is modifying a nominal or adjectival predicate of a copula verb were extracted. None of the utterances contained expletives (*there is no book*). The existence of a predicate was identified with the help of POS information and dependency relation. The POS of the predicate has to be either noun (*n*) or adjective (*adj*), and its dependency relation with the copula has to be *PRED*. This resulted in a total of `r format(nrow(learning), big.mark=",")` utterances (Child: `r format(sum(child_learning$Freq), big.mark=",")`; Parent: `r format(sum(parent_learning$Freq), big.mark=",")`).

&nbsp;
(10) *that's not a farmer* 

&nbsp;
(11) *I'm not a heavy baby Mum* 

&nbsp;
(12) *It's no good*


Comparing the three negative morphemes, the most frequently used is *not* regardless of the specific speaker, and the amount of production variability is comparable (~0.12) between child and parent speehc. Based on results from Figure \@ref{fig:learning}, the developmental trajectory of using the negative morphemes in the domain of language learning is comparable to previous domains. Children started using the negative morphemes for the function of labeling nominal objects more frequently around the age of 24 months; yet their usage gradually decreases around the age of 36 months.

```{r learning, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=3.5, fig.height=2, set.cap.width=T, num.cols.cap=1, fig.cap = "Language learning via labeling" }

learning_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(Ratio, 2), group = Role, color = Role)) +
  geom_point(aes(color = Role, shape = Role)) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("steelblue", "peru")) + 
  geom_line(aes(color = Role, linetype = Role)) + 
#  facet_grid(vars(Function)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("ratio")

```


### Non-existence

```{r perceptiondata, include=FALSE}

perception <-read.csv('data/neg_perception.txt', header = T, sep = '\t')
perception$Role[which(perception$Role == "Father")] <- 'Parent'
perception$Role[which(perception$Role == "Mother")] <- 'Parent'
perception$Role[which(perception$Role == "Target_Child")] <- 'Child'

child_existence <- subset(perception, Role %in% c('Child') & Function == 'existence')
parent_existence <- subset(perception, Role %in% c('Parent') & Function == 'existence')

child_existence <- data.frame(table(child_existence$Age))
child_existence$Role <- rep('Child', nrow(child_existence))
child_existence$Function <- rep('existence', nrow(child_existence))
child_existence$Ratio <- child_existence$Freq / sum(child_existence$Freq)

parent_existence <- data.frame(table(parent_existence$Age))
parent_existence$Role <- rep('Parent', nrow(parent_existence))
parent_existence$Function <- rep('existence', nrow(parent_existence))
parent_existence$Ratio <- parent_existence$Freq / sum(parent_existence$Freq)

existence_data <- rbind(child_existence,  parent_existence)
names(existence_data) <- c('Age', 'Freq', 'Role', 'Function', 'Ratio')

child_possession <- subset(perception, Role %in% c('Child') & Function == 'possession')
parent_possession <- subset(perception, Role %in% c('Parent') & Function == 'possession')

child_possession <- data.frame(table(child_possession$Age))
child_possession$Role <- rep('Child', nrow(child_possession))
child_possession$Function <- rep('possession', nrow(child_possession))
child_possession$Ratio <- child_possession$Freq / sum(child_possession$Freq)

parent_possession <- data.frame(table(parent_possession$Age))
parent_possession$Role <- rep('Parent', nrow(parent_possession))
parent_possession$Function <- rep('possession', nrow(parent_possession))
parent_possession$Ratio <- parent_possession$Freq / sum(parent_possession$Freq)

possession_data <- rbind(child_possession,  parent_possession)
names(possession_data) <- c('Age', 'Freq', 'Role', 'Function', 'Ratio')

```

The utterances to be analyzed here are cases combined with negative morphemes to express the function of non-existence. To do that, we extracted utterances that either have expletives marked by *there* (e.g. (13)), or cases where the negative morphemes are modifying a nominal (i.e. its syntactic head based on the CHILDES annotation is a nominal; e.g. (14)). With utterances such as (14) in particular, in order to not confuse with the function of labeling, we did not include any cases where the syntactic head of the negative morphemes is a predicate of a copula verb (e.g. *this is not candy*). This led to a total of `r format(sum(existence_data$Freq), big.mark=",")` utterances  (Child: `r format(sum(child_existence$Freq), big.mark=",")`; Parent: `r format(sum(parent_existence$Freq), big.mark=",")`).

&nbsp;
(13) *there's no water*

&nbsp;
(14) *no (more) candy* / *not your mouth*

In both child and parent speech, the most frequently occurred negative morphemes to indicate non-existence is *no*. The amount of production variability approximates 0.12 regardless of the specific speaker. Again for comparison of child and parent speech, we calculated the relative ratio of (i) each of the three negative morphemes overall; (ii) usage of negative morphemes with the two different communicative functions; (iii) utterances expression motor control with the three negative morphemes at different ages of the child. Overall the most frequently used negative morpheme is *n't* when applied in the domain of motor control. Comparing the two communicative functions, the negative morphemes tend to co-occur more often when expressing inability.

As shown in Figure \@ref{fig:existence}, children began increasing their use of the negative morphemes to express non-existence around the age of 22 months, whereas the frequency of applying these negative morphemes started to become less regular around the age of 36 months. 

```{r existence, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=3.5, fig.height=2, set.cap.width=T, num.cols.cap=1, fig.cap = "Non-existence" }

existence_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(Ratio, 2), group = Role, color = Role)) +
  geom_point(aes(color = Role, shape = Role)) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("steelblue", "peru")) + 
  geom_line(aes(color = Role, linetype = Role)) + 
#  facet_grid(vars(Function)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("ratio")

```

### Possession

The last function that we investigated includes utterances that are combined with negative morphemes to denote possession. Specifically, we selected cases where the negative morphemes are modifying a possessive pronoun (e.g. (15)), as well as instances where the negative morphemes are combined with auxiliary verbs to modify a head verb with the lemma form *have* (e.g. (16)). Again similarly to our search for utterances that express non-existence, we excluded cases in which the syntactic head of the negative morphemes is a predicate of a copula verb (e.g. *this is not mine*). As a result, the total of utterances that were subjected to analysis for this function is `r format(sum(possession_data$Freq), big.mark=",")`  (Child: `r format(sum(child_possession$Freq), big.mark=",")`; Parent: `r format(sum(parent_possession$Freq), big.mark=",")`). The developmental trajectory for this function, as shown in Figure \@ref[fig:possession], is comparable to that for the function of non-existence.

&nbsp;
(15) *not mine* 

&nbsp;
(16) *I don't have it*

```{r possession, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=3.5, fig.height=2, set.cap.width=T, num.cols.cap=1, fig.cap = "Possession" }

possession_data %>% 
  ggplot(aes(as.numeric(as.character(Age)), round(Ratio, 2), group = Role, color = Role)) +
  geom_point(aes(color = Role, shape = Role)) +
  scale_shape_manual(values = c(16, 3)) +
  scale_color_manual(values = c("steelblue", "peru")) + 
  geom_line(aes(color = Role, linetype = Role)) + 
#  facet_grid(vars(Function)) +
  scale_x_continuous(breaks=seq(0, 72, 6)) +
  theme_classic() + 
  theme(text = element_text(size=10, family="Times")) + 
  theme(legend.position="top") +
  xlab("child age (months)") + 
  ylab("ratio")

```

### An overall look at all functions

```{r alldata, include=FALSE}

names(emotion_data) <- c('Age', 'Freq', 'Role', 'Function', 'Ratio')
emotion_data$FUNCTION <- rep('Rejection', nrow(emotion_data))
names(epistemic_data) <- c('Age', 'Freq', 'Role', 'Function', 'Ratio')
epistemic_data$FUNCTION <- rep('Epistemic', nrow(epistemic_data))
prohibition_data$FUNCTION <- rep('Prohibition', nrow(prohibition_data))
inability_data$FUNCTION <- rep('Inability', nrow(inability_data))
learning_data$FUNCTION <- rep('Labeling', nrow(learning_data))
existence_data$FUNCTION <- rep('None-existence', nrow(existence_data))
possession_data$FUNCTION <- rep('Possession', nrow(possession_data))

all <- rbind(emotion_data, epistemic_data, prohibition_data, inability_data, learning_data, existence_data, possession_data)
child_all <- subset(all, Role %in% c('Target_Child', 'Child'))
parent_all <- subset(all, Role %in% c('Parent'))

child_together <- aggregate(Freq ~ Age + FUNCTION, data = child_all, sum)
child_together$Role <- rep('Child', nrow(child_together))
child_together$Prob <- rep(0, nrow(child_together))

for (i in 1:nrow(child_together)){
  age = as.numeric(as.character(child_together$Age[i]))
  data = subset(child_together, Age == age)
  child_together$Prob[i] = child_together$Freq[i] / sum(data$Freq)

  }

parent_together <- aggregate(Freq ~ Age + FUNCTION, data = parent_all, sum)
parent_together$Role <- rep('Parent', nrow(parent_together))
parent_together$Prob <- rep(0, nrow(parent_together))

for (i in 1:nrow(parent_together)){
  age = as.numeric(as.character(parent_together$Age[i]))
  data = subset(parent_together, Age == age)
  parent_together$Prob[i] = parent_together$Freq[i] / sum(data$Freq)

  }


together <- rbind(child_together, parent_together)
exclude <- subset(together, FUNCTION != 'None-existence')
```

\begin{figure*}[h]
```{r all, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=4, set.cap.width=T, num.cols.cap=1}

together %>%
  ggplot(aes(color=FUNCTION, x=as.numeric(as.character(Age)), y=Prob)) + 
    geom_point(aes(color = FUNCTION, shape = FUNCTION)) +
    geom_line(aes(color = FUNCTION, linetype = FUNCTION)) + 
    scale_color_brewer(palette = "Dark2") +
    scale_x_continuous(breaks=seq(0, 72, 6)) +
    facet_grid(.~Role) +
    theme_classic() +
    theme(text = element_text(size=10, family="Times")) + 
    theme(legend.position="top") +
    xlab("child age (months)") + 
    ylab("ratio") 

```
\caption[This image spans both columns]{All functions.}\label{fig:all}
\end{figure*}

\begin{figure*}[h]
```{r exclude, fig.env="figure", fig.pos = "H", fig.align = "center", fig.width=7, fig.height=4, set.cap.width=T, num.cols.cap=1}

exclude %>%
  ggplot(aes(color=FUNCTION, x=as.numeric(as.character(Age)), y=Prob)) + 
    geom_point(aes(color = FUNCTION, shape = FUNCTION)) +
    geom_line(aes(color = FUNCTION, linetype = FUNCTION)) + 
    scale_color_brewer(palette = "Dark2") +
    scale_x_continuous(breaks=seq(0, 72, 6)) +
    facet_grid(.~Role) +
    theme_classic() +
    theme(text = element_text(size=10, family="Times")) + 
    theme(legend.position="top") +
    xlab("child age (months)") + 
    ylab("ratio") 

```
\caption[This image spans both columns]{All functions except for None-existence.}\label{fig:exclude}
\end{figure*}

In this section, we combined all negative utterances analyzed above to examine how the production trajectory of each function develops *in relation to* the other functions. Therefore, the index of developmental characteristics for each function was measured as the relative ratio of the number of utterances within the particular function given a specific age of the child. For example, the total number of utterances with negative morphemes in child speech at the age of 66 months is 253, in which cases that express rejection have a frequency of 32. Then the relative ratio of the rejection function at this age is measured as 32 / 253 = 0.13.

As presented in Figure\@ref{fig:all}, child speech with negative morphemes bears considerable amount of similarity with parent speech in terms of the overall production patterns. The most frequently applied function is non-existence, while the functions with relatively smaller number of occurrences include possession and inability.

With that being said, there are a number of observant differences between child and parent utterances with respects to the amount of production variability. In both child and parent production, the function that has the highest amount of variability is non-existence (Child: `r round(entropy(subset(together, Role=='Child'&FUNCTION=='None-existence')),2)`; Parent: `r format(round(entropy(subset(together, Role=='Parent'&FUNCTION=='None-existence')),2), big.mark=",")`). 

With that being said, 

the overall production pattern as well as the pattern for each individual function. 

On the other hand, in comparison, the differences in production variability are more observant with the functions of prohibition (Child: `r format(round(entropy(subset(together, Role=='Child'&FUNCTION=='Prohibition')),2), big.mark=",")`; Parent: `r format(round(entropy(subset(together, Role=='Parent'&FUNCTION=='Prohibition')),2), big.mark=",")`) and labeling (Child: `r format(round(entropy(subset(together, Role=='Child'&FUNCTION=='Labeling')),2), big.mark=",")`; Parent: `r format(round(entropy(subset(together, Role=='Parent'&FUNCTION=='Labeling')),2), big.mark=",")`).


# Discussion

For future work, we would like to extend our current study in three respects. First, while here the analyses were restricted to only utterances with negative morphemes, we plan to also investigate the positive counterpart structures of these cases (e.g. *I don't know* vs. *I know*). This would allow us to see how the production trajectory of the negative morphemes develops within the broader context of particular syntactic constructions [@goldberg1995constructions]. Secondly, besides looking at the utterances produced by all children or parents, we intend to narrow our focus to the developmental trajectory of individual child, the data for which ideally contains production from a wider age range (e.g. 12 - 72 months.), This would allow us to further investigate individual differences in the development of negation. Lastly, our experiments thus far have concentrated on the utterance level, therefore cases where negations are used as discourse markers were excluded. However, discourse markers indeed have important roles in the communication between children and parents, where the negative morphemes could also be indicating the functions that have been analyzed above (e.g. Parent: *do you want some bread?*; Child: *no no no*). More thorough examinations of discourse-level instances as such would paint a more clear picture about the production of negation.

# References 

```{r}
# References will be generated automatically by Pandoc and included here.
# The following code is some latex to format the bibliography. Do not remove it.
```

\setlength{\parindent}{-0.1in} 
\setlength{\leftskip}{0.125in}
\noindent

